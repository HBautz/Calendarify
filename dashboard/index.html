<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calendarify Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #1A2E29;
      color: #E0E0E0;
    }
    .sidebar {
      background: #111f1c;
      border-right: 1px solid #1E3A34;
      min-height: 100vh;
      width: 260px;
      display: flex;
      flex-direction: column;
      padding: 32px 0 0 0;
    }
    .nav-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 0 24px;
    }
    .nav-divider {
      border: none;
      border-top: 1px solid #1E3A34;
      margin: 24px 0 16px 0;
    }
    .nav-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 12px 16px;
      border-radius: 12px;
      font-size: 1.08rem;
      font-weight: 500;
      color: #E0E0E0;
      background: none;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .nav-item.active { 
      background: #19342e;
      color: #34D399;
    }
    .nav-item.active .nav-icon {
      color: #34D399;
    }
    .nav-item .nav-icon {
      width: 24px;
      height: 24px;
      color: #A3B3AF;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: color 0.2s;
    }
    .nav-item:not(.active):hover {
      background: #1E3A34;
    }
    .nav-item:not(.active):hover .nav-icon {
      color: #34D399;
    }
    .nav-item .badge {
      background: linear-gradient(135deg, rgba(52, 211, 153, 0.2), rgba(52, 211, 153, 0.1));
      box-shadow: 0 0 10px rgba(52, 211, 153, 0.1);
    }
    .nav-item .badge.warning {
      background: linear-gradient(135deg, rgba(234, 179, 8, 0.2), rgba(234, 179, 8, 0.1));
      color: #eab308;
      box-shadow: 0 0 10px rgba(234, 179, 8, 0.1);
    }
    .nav-item .badge.error {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
      color: #ef4444;
      box-shadow: 0 0 10px rgba(239, 68, 68, 0.1);
    }
    .nav-group-title {
      text-shadow: 0 0 10px rgba(56, 189, 248, 0.1);
    }
    .nav-item::after {
      content: '';
      background: linear-gradient(135deg, rgba(56, 189, 248, 0.1), transparent);
    }
    .card {
      background: #1E3A34;
      border-radius: 1rem;
      padding: 1.5rem;
      color: #E0E0E0;
      box-shadow: none;
      transition: box-shadow 0.2s;
    }
    .card:hover {
      box-shadow: 0 2px 16px 0 rgba(52, 211, 153, 0.08);
    }
    .card-title {
      color: #E0E0E0;
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }
    .card-subtitle {
      color: #A3B3AF;
      font-size: 1rem;
      margin-bottom: 1rem;
    }
    .input-field {
      background: transparent;
      border: 1px solid #1E3A34;
      border-radius: 0.5rem;
      padding: 0.5rem 0.75rem;
      color: #E0E0E0;
      transition: border 0.2s;
    }
    .input-field:focus {
      border-color: #34D399;
      outline: none;
    }
    .search-field {
      background: #1E3A34 !important;
      border: 1px solid #2C4A43 !important;
      border-radius: 0.75rem !important;
      padding: 0.75rem 1rem 0.75rem 2.5rem !important;
      color: #E0E0E0 !important;
      font-size: 0.875rem !important;
      transition: all 0.2s ease !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    }
    .search-field:focus {
      border-color: #34D399 !important;
      box-shadow: 0 0 0 3px rgba(52, 211, 153, 0.1) !important;
      outline: none !important;
    }
    .search-field::placeholder {
      color: #A3B3AF !important;
    }
    .time-input {
      background-color: #19342e;
      border: 1px solid #2C4A43;
      color: #E0E0E0;
      padding: 0.5rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      transition: all 0.2s ease;
    }
    .time-input:focus {
      outline: none;
      border-color: #34D399;
      box-shadow: 0 0 0 2px rgba(52, 211, 153, 0.2);
    }
    .time-input:hover {
      border-color: #34D399;
    }
    .time-input:disabled {
      background-color: #111f1c;
      color: #6B7C78;
      cursor: not-allowed;
    }
    .time-input::-webkit-calendar-picker-indicator {
      filter: invert(1) brightness(0.8);
      cursor: pointer;
    }
    .time-input::-webkit-calendar-picker-indicator:hover {
      filter: invert(1) brightness(1);
    }
    .custom-checkbox:checked::after {
      content: '✓' !important;
      position: absolute !important;
      top: 50% !important;
      left: 50% !important;
      transform: translate(-50%, -50%) !important;
      color: #1A2E29 !important;
      font-size: 0.875rem !important;
      font-weight: bold !important;
    }
    .custom-checkbox:hover {
      border-color: #34D399 !important;
      box-shadow: 0 0 0 2px rgba(52, 211, 153, 0.1) !important;
    }
    .select-field {
      background: #1E3A34 !important;
      border: 1px solid #2C4A43 !important;
      border-radius: 0.5rem !important;
      padding: 0.5rem 0.75rem !important;
      color: #E0E0E0 !important;
      font-size: 0.875rem !important;
      transition: all 0.2s ease !important;
      cursor: pointer !important;
    }
    .select-field:focus {
      border-color: #34D399 !important;
      box-shadow: 0 0 0 2px rgba(52, 211, 153, 0.1) !important;
      outline: none !important;
    }
    .select-field option {
      background: #1E3A34 !important;
      color: #E0E0E0 !important;
    }
    .table-header {
      background: #1A2E29;
      color: #E0E0E0;
      font-weight: 600;
    }
    .table-row {
      background: none;
      transition: background 0.2s;
    }
    .table-row:hover {
      background: #1E3A34;
    }
    .badge-success {
      background: #34D39933;
      color: #34D399;
      border-radius: 9999px;
      padding: 0.25em 0.75em;
      font-size: 0.85em;
      font-weight: 600;
    }
    .badge-warning {
      background: #facc1533;
      color: #facc15;
      border-radius: 9999px;
      padding: 0.25em 0.75em;
      font-size: 0.85em;
      font-weight: 600;
    }
    .badge-error {
      background: #ef444433;
      color: #ef4444;
      border-radius: 9999px;
      padding: 0.25em 0.75em;
      font-size: 0.85em;
      font-weight: 600;
    }
    .badge-completed {
      background: none;
      color: #A3B3AF;
      border-radius: 9999px;
      padding: 0.25em 0.75em;
      font-size: 0.85em;
      font-weight: 600;
    }
    .notification-dot {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      width: 0.5rem;
      height: 0.5rem;
      background: #ef4444;
      border-radius: 9999px;
    }
    .calendar-day {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 9999px;
      transition: all 0.2s ease;
      cursor: pointer;
      width: 3.125rem;
      height: 3.125rem;
    }
    .calendar-day:hover {
      background-color: #2C4A43;
    }
    .calendar-day.today {
      background-color: #F97316; /* Orange color */
      color: #1A2E29;
      font-weight: bold;
    }
    .calendar-day.active {
      background-color: #34D399; /* Theme green color */
      color: #1A2E29;
      font-weight: bold;
    }
    .calendar-day.has-event {
      position: relative;
    }
    .calendar-day.has-event::after {
      content: '';
      position: absolute;
      bottom: 4px;
      width: 4px;
      height: 4px;
      background-color: #34D399;
      border-radius: 50%;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 51px;
      height: 31px;
      background-color: #19342e;
      border-radius: 31px;
      cursor: pointer;
      border: 1px solid #34D399;
      transition: background-color 0.3s ease;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
      position: absolute;
    }
    .toggle-slider {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #19342e;
      border-radius: 31px;
      border: 1px solid #34D399;
      transition: background-color 0.3s ease;
    }
    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 25px;
      width: 25px;
      left: 3px;
      top: 3px;
      background-color: #34D399;
      border-radius: 50%;
      transition: transform 0.3s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .toggle-switch input:checked + .toggle-slider {
      background-color: #34D399;
    }
    .toggle-switch input:checked + .toggle-slider:before {
      transform: translateX(20px);
      background-color: white;
    }
    .nav-link {
      color: #A3B3AF;
    }
    .nav-link:hover {
      color: #E0E0E0;
    }
    
    /* Time input styling */
    .time-input {
      background-color: #19342e;
      border: 1px solid #2C4A43;
      color: #E0E0E0;
      padding: 0.5rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      transition: all 0.2s ease;
    }
    
    .time-input:focus {
      outline: none;
      border-color: #34D399;
      box-shadow: 0 0 0 2px rgba(52, 211, 153, 0.2);
    }
    
    .time-input:hover {
      border-color: #34D399;
    }
    
    .time-input:disabled {
      background-color: #111f1c;
      color: #6B7C78;
      cursor: not-allowed;
    }
    
    /* Ensure time picker dropdown works */
    .time-input::-webkit-calendar-picker-indicator {
      filter: invert(1) brightness(0.8);
      cursor: pointer;
    }
    
    .time-input::-webkit-calendar-picker-indicator:hover {
      filter: invert(1) brightness(1);
    }
    
    /* Responsive improvements */
    @media (max-width: 1024px) {
      .time-input {
        width: 100% !important;
        max-width: 7rem;
      }
    }
    
    @media (max-width: 768px) {
      .time-input {
        width: 100% !important;
        max-width: 6rem;
      }
    }
    
    /* Dashboard responsive improvements */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    
    @media (max-width: 1024px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
    }
    .time-dropdown { background-color: #1E3A34 !important; opacity: 1 !important; }
    /* Remove native select arrows for custom time picker */
    .custom-time-picker select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-image: none !important;
      padding-right: 0.5rem;
    }
    .custom-time-picker select:focus {
      outline: none;
      box-shadow: 0 0 0 2px #34D39944;
    }
    /* Optionally, add a custom arrow if you want */
    /* .custom-time-picker select { background: url('data:image/svg+xml;...') no-repeat right center/1em; } */

    /* --- Actions column alignment --- */
    td.actions-col {
      text-align: right;
      vertical-align: middle;
      position: relative;
      width: 1%;
      white-space: nowrap;
    }
    .meeting-menu {
      z-index: 9999;
      min-width: 140px;
      right: 0;
      top: 100%;
      margin-top: 4px;
      position: absolute;
    }
    .meeting-menu.open {
      display: block;
    }
    .meeting-menu:not(.open) {
      display: none;
    }
    .meeting-menu button {
      text-align: left;
      width: 100%;
    }
    .meeting-menu .material-icons-outlined {
      font-size: 1.1em;
    }
    .kebab-btn {
      cursor: pointer;
    }
    .btn-secondary {
      background: #19342e;
      color: #A3B3AF;
      border: 1px solid #2C4A43;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .btn-secondary:hover {
      background: #2C4A43;
      color: #E0E0E0;
      border-color: #34D399;
    }
    .btn-join {
      background: #34D399;
      color: #1A2E29;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .btn-join:hover {
      background: #2C4A43;
    }
    .btn-reschedule {
      background: #19342e;
      color: #A3B3AF;
      border: 1px solid #2C4A43;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .btn-reschedule:hover {
      background: #2C4A43;
      color: #E0E0E0;
      border-color: #34D399;
    }
    .btn-cancel {
      background: #ef4444;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .btn-cancel:hover {
      background: #dc2626;
    }
    .contact-menu {
      z-index: 9999;
      min-width: 140px;
      right: 0;
      top: 100%;
      margin-top: 4px;
      position: absolute;
    }
    .contact-menu.open {
      display: block;
    }
    .contact-menu:not(.open) {
      display: none;
    }
    .contact-menu button {
      text-align: left;
      width: 100%;
    }
    .contact-menu .material-icons-outlined {
      font-size: 1.1em;
    }
    .favorite-btn {
      cursor: pointer;
      padding: 0.25rem;
      border-radius: 0.25rem;
      transition: all 0.2s ease;
    }
    .favorite-btn:hover {
      background-color: rgba(52, 211, 153, 0.1);
    }
    .favorite-btn.favorited {
      color: #34D399 !important;
    }
    .favorite-btn.favorited:hover {
      color: #A3B3AF !important;
    }
    .favorites-filter-active {
      background: #34D399 !important;
      color: #1A2E29 !important;
    }
    .favorites-filter-active:hover {
      background: #2C4A43 !important;
    }
  </style>
</head>
<body class="flex min-h-screen">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="px-6 pb-8">
      <a href="/" class="flex items-center gap-2">
      <span class="material-icons-outlined text-3xl text-[#34D399]">calendar_month</span>
        <h1 class="text-2xl font-bold text-[#34D399] tracking-tight">Calendarify</h1>
      </a>
    </div>
    <nav class="flex-1">
      <div class="nav-list">
        <div class="nav-item active" data-section="event-types" onclick="showSection('event-types', this)">
          <span class="nav-icon"> <!-- link icon -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6.75h3.75A2.25 2.25 0 0120 9v6a2.25 2.25 0 01-2.25 2.25h-3.75m-3-12H6.75A2.25 2.25 0 004.5 9v6a2.25 2.25 0 002.25 2.25h3.75" /></svg>
          </span>
          Event types
        </div>
        <div class="nav-item" data-section="meetings" onclick="showSection('meetings', this)">
          <span class="nav-icon"> <!-- calendar icon -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><rect x="3" y="5" width="18" height="16" rx="2"/><path stroke-linecap="round" stroke-linejoin="round" d="M16 3v4M8 3v4M3 9h18"/></svg>
          </span>
          Meetings
        </div>
        <div class="nav-item" data-section="availability" onclick="showSection('availability', this)">
          <span class="nav-icon"> <!-- clock icon -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><circle cx="12" cy="12" r="9"/><path stroke-linecap="round" stroke-linejoin="round" d="M12 7v5l3 3"/></svg>
          </span>
          Availability
        </div>
      </div>
      <hr class="nav-divider">
      <div class="nav-list">
        <div class="nav-item" data-section="contacts" onclick="showSection('contacts', this)">
          <span class="nav-icon"> <!-- users icon -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a4 4 0 00-3-3.87M9 20H4v-2a4 4 0 013-3.87m9-7a4 4 0 11-8 0 4 4 0 018 0zm6 4v6m-6-6v6"/></svg>
          </span>
          Contacts
        </div>
        <div class="nav-item" data-section="workflows" onclick="showSection('workflows', this)">
          <span class="nav-icon"> <!-- workflow icon -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><circle cx="6" cy="6" r="2"/><circle cx="18" cy="6" r="2"/><circle cx="6" cy="18" r="2"/><circle cx="18" cy="18" r="2"/><path stroke-linecap="round" stroke-linejoin="round" d="M8 6h8M6 8v8m12-8v8M8 18h8"/></svg>
          </span>
          Workflows
        </div>
        <div class="nav-item" data-section="integrations" onclick="showSection('integrations', this)">
          <span class="nav-icon"> <!-- apps icon -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><rect x="3" y="3" width="7" height="7" rx="2"/><rect x="14" y="3" width="7" height="7" rx="2"/><rect x="14" y="14" width="7" height="7" rx="2"/><rect x="3" y="14" width="7" height="7" rx="2"/></svg>
          </span>
          Integrations & apps
        </div>
        <div class="nav-item" data-section="routing" onclick="showSection('routing', this)">
          <span class="nav-icon"> <!-- routing icon -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M17 17l4-4m0 0l-4-4m4 4H7a4 4 0 01-4-4V5"/></svg>
          </span>
          Routing
        </div>
      </div>
    </nav>
  </aside>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col">
    <!-- Header -->
    <header class="bg-[#111f1c] border-b border-[#1E3A34] p-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center gap-4">
          <h2 class="text-xl font-bold text-white" id="section-title">Event Types</h2>
          <div class="relative">
            <input type="text" placeholder="Search..." class="search-field w-64">
            <span class="material-icons-outlined absolute left-3 top-1/2 -translate-y-1/2 text-[#A3B3AF]">search</span>
          </div>
        </div>
        <div class="flex items-center gap-4">
          <button class="relative p-2 text-[#A3B3AF] hover:text-white transition-colors">
            <span class="material-icons-outlined">notifications</span>
            <span class="notification-dot"></span>
          </button>
          <button class="relative p-2 text-[#A3B3AF] hover:text-white transition-colors">
            <span class="material-icons-outlined">help_outline</span>
          </button>
          <div class="relative">
            <img src="https://ui-avatars.com/api/?name=User&background=34D399&color=1A2E29" alt="Profile" class="w-10 h-10 rounded-full cursor-pointer hover:opacity-80 transition-opacity">
          </div>
        </div>
      </div>
    </header>

    <main class="flex-1 p-8 overflow-y-auto">
      <!-- Event Types Section -->
      <section id="event-types-section">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-white">Event Types</h2>
          <div class="relative">
            <button class="bg-[#34D399] text-[#1A2E29] px-4 py-2 rounded-lg hover:bg-[#2C4A43] transition-colors text-sm font-bold flex items-center gap-2" onclick="openCreateEventTypeModal()">
              <span class="material-icons-outlined">add</span>
              Create
            </button>
          </div>
        </div>
        <div class="dashboard-grid" id="event-types-grid">
          <div class="card flex flex-col gap-3">
            <div class="flex items-center justify-between">
              <div>
                <h3 class="text-lg font-bold text-white">30-min Intro Call</h3>
                <div class="text-[#A3B3AF] text-sm">1-on-1 • 30 min</div>
            </div>
              <button class="text-[#A3B3AF] hover:text-[#34D399]" title="Favorite"><span class="material-icons-outlined">star_border</span></button>
          </div>
            <div class="flex gap-2 mt-2">
              <button class="bg-[#19342e] text-[#34D399] px-3 py-1 rounded-lg flex items-center gap-1 text-sm" onclick="copyLink('https://cal.example/intro')"><span class="material-icons-outlined text-base">link</span>Copy link</button>
              <button class="bg-[#19342e] text-[#34D399] px-3 py-1 rounded-lg flex items-center gap-1 text-sm" onclick="openShareModal('30-min Intro Call')"><span class="material-icons-outlined text-base">share</span>Share</button>
              <div class="relative">
                <button class="text-[#A3B3AF] hover:text-[#34D399] px-2 py-1 rounded-full" onclick="toggleCardMenu(this)"><span class="material-icons-outlined">more_vert</span></button>
                <div class="absolute right-0 mt-2 w-40 bg-[#1E3A34] rounded-lg shadow-lg py-2 z-50 hidden card-menu">
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]">Edit</button>
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]">Clone</button>
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]">Add Note</button>
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]">Mark Secret</button>
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]" onclick="deleteEventType('${eventType.id}')">Delete</button>
            </div>
          </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Meetings Section -->
      <section id="meetings-section" style="display:none;">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-white">Meetings</h2>
          <div class="flex items-center gap-4">
            <input type="text" class="search-field w-64" placeholder="Search meetings..." oninput="handleMeetingsSearch(event)">
            <button class="bg-[#34D399] text-[#1A2E29] px-4 py-2 rounded-lg hover:bg-[#2C4A43] transition-colors text-sm font-bold" onclick="exportCSV()">Export CSV</button>
          </div>
        </div>
        <div class="bg-[#1E3A34] rounded-xl">
          <div class="flex border-b border-[#1A2E29]">
            <button data-tab="upcoming" class="px-6 py-3 bg-[#34D399] text-[#1A2E29] font-medium" onclick="showMeetingsTab('upcoming', this)">Upcoming</button>
            <button data-tab="past" class="px-6 py-3 text-[#A3B3AF] hover:text-white" onclick="showMeetingsTab('past', this)">Past</button>
            <button data-tab="pending" class="px-6 py-3 text-[#A3B3AF] hover:text-white" onclick="showMeetingsTab('pending', this)">Pending</button>
          </div>
          <div class="p-4">
            <table class="w-full">
              <thead class="table-header">
                <tr>
                  <th class="text-center py-2 w-1/4">Invitee</th>
                  <th class="text-center py-2 w-1/5">Event Type</th>
                  <th class="text-center py-2 w-1/5">Date/Time</th>
                  <th class="text-center py-2 w-1/6">Status</th>
                  <th class="text-center py-2 w-1/6">Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Table content will be dynamically populated by JavaScript -->
              </tbody>
            </table>
                </div>
              </div>
      </section>

      <!-- Availability Section -->
      <section id="availability-section" style="display:none;">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-white">Availability</h2>
          <div class="flex items-center gap-4">
            <div class="flex items-center gap-2">
              <label for="clock-format-toggle" class="flex items-center gap-2 cursor-pointer select-none">
                <span class="text-[#A3B3AF] text-sm">12h format</span>
                <button id="clock-format-toggle" type="button" aria-pressed="false" class="w-12 h-7 bg-[#19342e] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleClockFormat()">
                  <div id="toggle-circle" class="w-6 h-6 bg-[#34D399] rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s;"></div>
                </button>
              </label>
          </div>
          </div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="card">
            <h3 class="text-lg font-bold text-white mb-4">Weekly Hours</h3>
            <div class="space-y-3">
              <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-2">
                <span class="text-[#A3B3AF] w-24 flex-shrink-0">Monday</span>
                <div class="flex items-center gap-2 flex-shrink-0">
                  <div class="flex items-center gap-2" id="monday-times">
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="09:00 AM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
                </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
                </div>
              </div>
                    </span>
                    <span class="text-[#A3B3AF] flex-shrink-0">to</span>
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="17:00 PM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
                </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
                </div>
              </div>
                    </span>
            </div>
                  <button type="button" aria-pressed="true" class="w-12 h-7 bg-[#34D399] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleDayAvailability('monday', this)">
                    <div class="w-6 h-6 bg-white rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s; transform:translateX(20px);"></div>
                  </button>
          </div>
        </div>
              <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-2">
                <span class="text-[#A3B3AF] w-24 flex-shrink-0">Tuesday</span>
                <div class="flex items-center gap-2 flex-shrink-0">
                  <div class="flex items-center gap-2" id="tuesday-times">
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="09:00 AM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
          </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
              </div>
              </div>
                    </span>
                    <span class="text-[#A3B3AF] flex-shrink-0">to</span>
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="17:00 PM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
            </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
              </div>
              </div>
                    </span>
            </div>
                  <button type="button" aria-pressed="true" class="w-12 h-7 bg-[#34D399] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleDayAvailability('tuesday', this)">
                    <div class="w-6 h-6 bg-white rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s; transform:translateX(20px);"></div>
                  </button>
          </div>
        </div>
              <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-2">
                <span class="text-[#A3B3AF] w-24 flex-shrink-0">Wednesday</span>
                <div class="flex items-center gap-2 flex-shrink-0">
                  <div class="flex items-center gap-2" id="wednesday-times">
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="09:00 AM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
                        </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
                        </div>
                      </div>
                    </span>
                    <span class="text-[#A3B3AF] flex-shrink-0">to</span>
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="17:00 PM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
                        </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
                        </div>
                      </div>
                    </span>
                  </div>
                  <button type="button" aria-pressed="true" class="w-12 h-7 bg-[#34D399] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleDayAvailability('wednesday', this)">
                    <div class="w-6 h-6 bg-white rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s; transform:translateX(20px);"></div>
          </button>
        </div>
              </div>
              <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-2">
                <span class="text-[#A3B3AF] w-24 flex-shrink-0">Thursday</span>
                <div class="flex items-center gap-2 flex-shrink-0">
                  <div class="flex items-center gap-2" id="thursday-times">
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="09:00 AM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
                        </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
                        </div>
                      </div>
                    </span>
                    <span class="text-[#A3B3AF] flex-shrink-0">to</span>
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="17:00 PM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
                        </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
                        </div>
                      </div>
                    </span>
                  </div>
                  <button type="button" aria-pressed="true" class="w-12 h-7 bg-[#34D399] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleDayAvailability('thursday', this)">
                    <div class="w-6 h-6 bg-white rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s; transform:translateX(20px);"></div>
                </button>
              </div>
            </div>
              <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-2">
                <span class="text-[#A3B3AF] w-24 flex-shrink-0">Friday</span>
                <div class="flex items-center gap-2 flex-shrink-0">
                  <div class="flex items-center gap-2" id="friday-times">
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="09:00 AM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
              </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
              </div>
            </div>
                    </span>
                    <span class="text-[#A3B3AF] flex-shrink-0">to</span>
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="17:00 PM" onclick="showTimeDropdown(this)">
                      <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
                        <div class="flex gap-2 items-center justify-center">
                          <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <span class="text-[#A3B3AF]">:</span>
                          <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                          <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
            </div>
                        <div class="flex justify-end mt-2 gap-2 w-full">
                          <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                          <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
          </div>
        </div>
                    </span>
                  </div>
                  <button type="button" aria-pressed="true" class="w-12 h-7 bg-[#34D399] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleDayAvailability('friday', this)">
                    <div class="w-6 h-6 bg-white rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s; transform:translateX(20px);"></div>
                  </button>
                </div>
              </div>
              <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-2">
                <span class="text-[#A3B3AF] w-24 flex-shrink-0">Saturday</span>
                <div class="flex items-center gap-2 flex-shrink-0">
                  <div class="flex items-center gap-2 opacity-50" id="saturday-times">
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly disabled class="time-input w-full flex-shrink-0 cursor-not-allowed bg-[#111f1c] border border-[#2C4A43] text-[#6B7C78] rounded px-3 py-2" placeholder="09:00 AM">
                    </span>
                    <span class="text-[#A3B3AF] flex-shrink-0">to</span>
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly disabled class="time-input w-full flex-shrink-0 cursor-not-allowed bg-[#111f1c] border border-[#2C4A43] text-[#6B7C78] rounded px-3 py-2" placeholder="17:00 PM">
                    </span>
                  </div>
                  <button type="button" aria-pressed="false" class="w-12 h-7 bg-[#19342e] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleDayAvailability('saturday', this)">
                    <div class="w-6 h-6 bg-[#34D399] rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s; transform:translateX(0);"></div>
                  </button>
                </div>
              </div>
              <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-2">
                <span class="text-[#A3B3AF] w-24 flex-shrink-0">Sunday</span>
                <div class="flex items-center gap-2 flex-shrink-0">
                  <div class="flex items-center gap-2 opacity-50" id="sunday-times">
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly disabled class="time-input w-full flex-shrink-0 cursor-not-allowed bg-[#111f1c] border border-[#2C4A43] text-[#6B7C78] rounded px-3 py-2" placeholder="09:00 AM">
                    </span>
                    <span class="text-[#A3B3AF] flex-shrink-0">to</span>
                    <span class="custom-time-picker relative inline-flex items-center w-28">
                      <input type="text" readonly disabled class="time-input w-full flex-shrink-0 cursor-not-allowed bg-[#111f1c] border border-[#2C4A43] text-[#6B7C78] rounded px-3 py-2" placeholder="17:00 PM">
                    </span>
                  </div>
                  <button type="button" aria-pressed="false" class="w-12 h-7 bg-[#19342e] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleDayAvailability('sunday', this)">
                    <div class="w-6 h-6 bg-[#34D399] rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s; transform:translateX(0);"></div>
                  </button>
                </div>
              </div>
          </div>
            </div>
          <div class="card">
            <h3 class="text-lg font-bold text-white mb-4">Calendar Overrides</h3>
            <div class="bg-[#1A2E29] p-4 rounded-lg">
              <div class="flex justify-between items-center mb-4">
                <button class="text-[#A3B3AF] hover:text-white transition-colors" onclick="previousMonth()">
                  <span class="material-icons-outlined">chevron_left</span>
                </button>
                <h4 class="font-medium text-white" id="calendar-month-year">June 2024</h4>
                <button class="text-[#A3B3AF] hover:text-white transition-colors" onclick="nextMonth()">
                  <span class="material-icons-outlined">chevron_right</span>
                </button>
              </div>
              <div class="grid grid-cols-7 gap-1 text-center text-sm mb-4">
                <div class="text-[#A3B3AF] py-2">Su</div>
                <div class="text-[#A3B3AF] py-2">Mo</div>
                <div class="text-[#A3B3AF] py-2">Tu</div>
                <div class="text-[#A3B3AF] py-2">We</div>
                <div class="text-[#A3B3AF] py-2">Th</div>
                <div class="text-[#A3B3AF] py-2">Fr</div>
                <div class="text-[#A3B3AF] py-2">Sa</div>
              </div>
              <div class="grid grid-cols-7 gap-1 text-center text-sm" id="calendar-days">
                <!-- Calendar days will be generated by JavaScript -->
              </div>
            </div>
            
            <!-- Override List -->
            <div class="mt-6">
              <h4 class="text-white font-medium mb-3">Active Overrides</h4>
              <div id="override-list" class="space-y-2">
                <!-- Override items will be generated by JavaScript -->
              </div>
            </div>
          </div>
        </section>

      <!-- Contacts Section -->
      <section id="contacts-section" style="display:none;">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-white">Contacts</h2>
          <button class="bg-[#34D399] text-[#1A2E29] px-4 py-2 rounded-lg hover:bg-[#2C4A43] transition-colors text-sm font-bold flex items-center gap-2" onclick="addContact()">
            <span class="material-icons-outlined">person_add</span>
            Add Contact
          </button>
            </div>
        <div class="mb-4 flex items-center gap-4">
          <input type="text" class="search-field w-64" placeholder="Search contacts..." oninput="handleSearch(event)">
          <button id="favorites-filter-btn" class="bg-[#19342e] text-[#34D399] px-3 py-1 rounded-lg flex items-center gap-1 text-sm hover:bg-[#2C4A43] transition-colors" onclick="toggleFavorites()"><span class="material-icons-outlined text-base">star</span>Favorites</button>
          </div>
        <div class="bg-[#1E3A34] rounded-xl p-4">
          <table class="w-full">
            <thead class="table-header">
              <tr>
                <th class="text-center py-2 w-1/8">Favorite</th>
                <th class="text-center py-2 w-1/4">Name</th>
                <th class="text-center py-2 w-1/3">Email</th>
                <th class="text-center py-2 w-1/4">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr class="table-row">
                <td class="py-2 text-center">
                  <button class="favorite-btn text-[#A3B3AF] hover:text-[#34D399] transition-colors" onclick="toggleFavorite('jane@example.com', this)">
                    <span class="material-icons-outlined text-xl">star_border</span>
                  </button>
                </td>
                <td class="py-2 text-center">Jane Doe</td>
                <td class="py-2 text-center">jane@example.com</td>
                <td class="py-2 text-center">
                  <div class="flex gap-2 justify-center">
                    <button class="btn-secondary" onclick="viewContact('jane@example.com')">View</button>
                    <div class="relative inline-block text-left">
                      <button class="kebab-btn flex items-center justify-center w-8 h-8 rounded-full hover:bg-[#223c36] transition-colors" type="button" onclick="toggleContactMenu(this)">
                        <span class="material-icons-outlined">more_vert</span>
                      </button>
                      <div class="contact-menu absolute bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50">
                        <button class="w-full flex items-center gap-2 px-4 py-2 text-[#34D399] hover:bg-[#223c36] text-sm font-semibold" onclick="bookContact('jane@example.com')">
                          <span class="material-icons-outlined text-xs">event</span>Book
                        </button>
                        <button class="w-full flex items-center gap-2 px-4 py-2 text-[#EF4444] hover:bg-[#223c36] text-sm font-semibold" onclick="removeContact('jane@example.com')">
                          <span class="material-icons-outlined text-xs">delete</span>Remove
                        </button>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
              <tr class="table-row">
                <td class="py-2 text-center">
                  <button class="favorite-btn text-[#34D399] hover:text-[#A3B3AF] transition-colors" onclick="toggleFavorite('john@company.com', this)">
                    <span class="material-icons-outlined text-xl">star</span>
                  </button>
                </td>
                <td class="py-2 text-center">John Smith</td>
                <td class="py-2 text-center">john@company.com</td>
                <td class="py-2 text-center">
                  <div class="flex gap-2 justify-center">
                    <button class="btn-secondary" onclick="viewContact('john@company.com')">View</button>
                    <div class="relative inline-block text-left">
                      <button class="kebab-btn flex items-center justify-center w-8 h-8 rounded-full hover:bg-[#223c36] transition-colors" type="button" onclick="toggleContactMenu(this)">
                        <span class="material-icons-outlined">more_vert</span>
                      </button>
                      <div class="contact-menu absolute bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50">
                        <button class="w-full flex items-center gap-2 px-4 py-2 text-[#34D399] hover:bg-[#223c36] text-sm font-semibold" onclick="bookContact('john@company.com')">
                          <span class="material-icons-outlined text-xs">event</span>Book
                        </button>
                        <button class="w-full flex items-center gap-2 px-4 py-2 text-[#EF4444] hover:bg-[#223c36] text-sm font-semibold" onclick="removeContact('john@company.com')">
                          <span class="material-icons-outlined text-xs">delete</span>Remove
                        </button>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Workflows Section -->
      <section id="workflows-section" style="display:none;">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-white">Workflows</h2>
          <button class="bg-[#34D399] text-[#1A2E29] px-4 py-2 rounded-lg hover:bg-[#2C4A43] transition-colors text-sm font-bold flex items-center gap-2" onclick="createWorkflow()">
            <span class="material-icons-outlined">add</span>
            Create Workflow
                    </button>
                  </div>
        <div class="bg-[#1E3A34] rounded-xl p-4">
          <table class="w-full">
            <thead class="table-header">
              <tr>
                <th class="text-left py-2">Name</th>
                <th class="text-left py-2">Status</th>
                <th class="text-left py-2">Event Types</th>
                <th class="text-left py-2">Last Edited</th>
                <th class="text-left py-2">Actions</th>
              </tr>
            </thead>
            <tbody id="workflows-tbody">
            </tbody>
          </table>
        </div>
      </section>

      <!-- Integrations & Apps Section -->
      <section id="integrations-section" style="display:none;">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-white">Integrations</h2>
          <input type="text" class="search-field w-64" placeholder="Search integrations...">
            </div>
        <div class="flex gap-4 mb-4">
          <button class="btn-secondary">All</button>
          <button class="btn-secondary">Video</button>
          <button class="btn-secondary">CRM</button>
          <button class="btn-secondary">Payments</button>
          <button class="btn-secondary">Analytics</button>
                </div>
        <div class="dashboard-grid">
          <div class="card flex flex-col gap-3">
            <div class="flex items-center gap-3">
              <span class="material-icons-outlined text-2xl text-[#34D399]">videocam</span>
              <div>
                <div class="text-white font-bold">Zoom</div>
                <div class="text-[#A3B3AF] text-sm">Video</div>
              </div>
            </div>
            <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded-lg font-bold mt-2">Connect</button>
          </div>
          <div class="card flex flex-col gap-3">
            <div class="flex items-center gap-3">
              <span class="material-icons-outlined text-2xl text-[#34D399]">payments</span>
          <div>
                <div class="text-white font-bold">Stripe</div>
                <div class="text-[#A3B3AF] text-sm">Payments</div>
              </div>
              </div>
            <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded-lg font-bold mt-2">Connect</button>
            </div>
          <div class="card flex flex-col gap-3">
            <div class="flex items-center gap-3">
              <span class="material-icons-outlined text-2xl text-[#34D399]">analytics</span>
              <div>
                <div class="text-white font-bold">Google Analytics</div>
                <div class="text-[#A3B3AF] text-sm">Analytics</div>
              </div>
            </div>
            <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded-lg font-bold mt-2">Connect</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modals -->
  <div id="modal-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden"></div>
  <div id="share-modal" class="fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-[#1E3A34] rounded-xl p-8 z-50 hidden" style="min-width:300px;">
    <h3 class="text-lg font-bold text-white mb-4">Share "<span id="share-modal-title"></span>"</h3>
    <div class="flex gap-2 mb-4">
      <input type="text" class="input-field flex-1" value="https://cal.example/intro" readonly>
      <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded-lg font-bold" onclick="copyLink('https://cal.example/intro')">Copy</button>
    </div>
    <button class="btn-secondary" onclick="closeShareModal()">Close</button>
  </div>

  <!-- Calendar Override Modal -->
  <div id="override-modal" class="fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-[#1E3A34] rounded-xl p-8 z-50 hidden" style="min-width:400px;">
    <h3 class="text-lg font-bold text-white mb-4">Set Custom Availability</h3>
    <div class="mb-4">
      <p class="text-[#A3B3AF] mb-2">Date: <span id="override-date" class="text-white font-medium"></span></p>
    </div>
    
    <div class="space-y-4">
      <div class="flex items-center gap-2">
        <button type="button" aria-pressed="false" class="w-12 h-7 bg-[#34D399] rounded-full relative cursor-pointer border border-[#34D399] transition-colors duration-300" onclick="toggleOverrideAvailability(this)">
          <div class="w-6 h-6 bg-white rounded-full absolute" style="top:1px; left:1px; transition:transform 0.3s, background-color 0.3s; transform:translateX(20px);"></div>
        </button>
        <span class="text-[#A3B3AF] text-sm">Available on this date</span>
      </div>
      
      <div id="override-times" class="space-y-3">
        <div class="flex items-center gap-2">
          <span class="custom-time-picker relative inline-flex items-center w-28">
            <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="09:00 AM" onclick="showTimeDropdown(this)">
            <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
              <div class="flex gap-2 items-center justify-center">
                <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                <span class="text-[#A3B3AF]">:</span>
                <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
              </div>
              <div class="flex justify-end mt-2 gap-2 w-full">
                <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
              </div>
            </div>
          </span>
          <span class="text-[#A3B3AF] flex-shrink-0">to</span>
          <span class="custom-time-picker relative inline-flex items-center w-28">
            <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="17:00 PM" onclick="showTimeDropdown(this)">
            <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
              <div class="flex gap-2 items-center justify-center">
                <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                <span class="text-[#A3B3AF]">:</span>
                <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
              </div>
              <div class="flex justify-end mt-2 gap-2 w-full">
                <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
              </div>
            </div>
          </span>
          <button class="text-[#A3B3AF] hover:text-[#34D399] transition-colors duration-200 p-1 rounded hover:bg-[#19342e] flex-shrink-0" onclick="addOverrideTimeSlot()">
            <span class="material-icons-outlined text-lg">add</span>
          </button>
        </div>
      </div>
      
      <div class="flex gap-3 pt-4">
        <button class="bg-[#34D399] text-[#1A2E29] px-6 py-2 rounded-lg font-bold hover:bg-[#2C4A43] transition-colors" onclick="saveOverride()">Save Override</button>
        <button class="text-[#A3B3AF] px-6 py-2 rounded-lg hover:text-white transition-colors" onclick="closeOverrideModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="delete-confirm-modal" class="fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-[#1E3A34] rounded-xl p-8 z-50 hidden" style="min-width:400px;">
    <div class="flex items-center gap-3 mb-4">
      <span class="material-icons-outlined text-2xl text-red-400">warning</span>
      <h3 class="text-lg font-bold text-white">Delete Override</h3>
    </div>
    <p class="text-[#A3B3AF] mb-6">Are you sure you want to delete this override? This action cannot be undone.</p>
    <div class="flex gap-3">
      <button class="bg-red-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-600 transition-colors" onclick="confirmDeleteOverride()">Delete</button>
      <button class="text-[#A3B3AF] px-6 py-2 rounded-lg hover:text-white transition-colors" onclick="closeDeleteConfirmModal()">Cancel</button>
    </div>
  </div>

  <!-- Cancel Meeting Confirmation Modal -->
  <div id="cancel-meeting-confirm-modal" class="fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-[#1E3A34] rounded-xl p-8 z-50 hidden" style="min-width:400px;">
    <div class="flex items-center gap-3 mb-4">
      <span class="material-icons-outlined text-2xl text-red-400">warning</span>
      <h3 class="text-lg font-bold text-white">Cancel Meeting</h3>
    </div>
    <p class="text-[#A3B3AF] mb-6">Are you sure you want to cancel this meeting? This action cannot be undone.</p>
    <div class="flex gap-3">
      <button class="bg-red-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-600 transition-colors" onclick="confirmCancelMeeting()">Cancel</button>
      <button class="text-[#A3B3AF] px-6 py-2 rounded-lg hover:text-white transition-colors" onclick="closeCancelMeetingConfirmModal()">Close</button>
    </div>
  </div>

  <!-- Add Contact Modal -->
  <div id="add-contact-modal" class="fixed inset-0 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-[#1E3A34] rounded-xl shadow-2xl w-full max-w-md">
        <!-- Header -->
        <div class="flex items-center justify-between p-6 border-b border-[#2C4A43]">
          <h2 class="text-xl font-bold text-white">Add New Contact</h2>
          <button onclick="closeAddContactModal()" class="text-[#A3B3AF] hover:text-white transition-colors">
            <span class="material-icons-outlined text-2xl">close</span>
          </button>
        </div>

        <!-- Content -->
        <div class="p-6 space-y-4">
          <div>
            <label for="contact-name" class="block text-[#A3B3AF] text-sm font-medium mb-2">Full Name *</label>
            <input type="text" id="contact-name" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="Enter full name">
          </div>
          
          <div>
            <label for="contact-email" class="block text-[#A3B3AF] text-sm font-medium mb-2">Email Address *</label>
            <input type="email" id="contact-email" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="Enter email address">
          </div>
          
          <div>
            <label for="contact-phone" class="block text-[#A3B3AF] text-sm font-medium mb-2">Phone Number</label>
            <input type="tel" id="contact-phone" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="Enter phone number">
          </div>
          
          <div>
            <label for="contact-company" class="block text-[#A3B3AF] text-sm font-medium mb-2">Company</label>
            <input type="text" id="contact-company" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="Enter company name">
          </div>
          
          <div>
            <label for="contact-notes" class="block text-[#A3B3AF] text-sm font-medium mb-2">Notes</label>
            <textarea id="contact-notes" rows="3" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors resize-none" placeholder="Add any notes about this contact"></textarea>
          </div>
          
          <div class="flex items-center gap-3">
            <input type="checkbox" id="contact-favorite" class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
            <label for="contact-favorite" class="text-[#E0E0E0] text-sm">Add to favorites</label>
          </div>
        </div>

        <!-- Footer -->
        <div class="flex items-center justify-end gap-3 p-6 border-t border-[#2C4A43]">
          <button onclick="closeAddContactModal()" class="px-6 py-3 text-[#A3B3AF] hover:text-white transition-colors font-medium">
            Cancel
          </button>
          <button onclick="saveContact()" class="bg-[#34D399] text-[#1A2E29] px-6 py-3 rounded-lg hover:bg-[#2C4A43] transition-colors font-bold">
            Add Contact
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Navigation functionality
    function showSection(section, el) {
      // Remove active class from all nav items
      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      
      // Add active class to clicked item
      el.classList.add('active');
      
      // Update section title
      document.getElementById('section-title').textContent = el.textContent.trim();
      
      // Hide all sections
      document.querySelectorAll('section').forEach(sec => sec.style.display = 'none');
      
      // Show the selected section
      const secEl = document.getElementById(section + '-section');
      if (secEl) secEl.style.display = 'block';
      
      
      // Initialize section-specific functionality
      if (section === 'meetings') {
        const defaultTab = document.querySelector('#meetings-section button[data-tab="upcoming"]');
        showMeetingsTab('upcoming', defaultTab);
      } else if (section === 'availability') {
        initializeCalendar();
      }
    }

    // Meetings tab functionality
    function showMeetingsTab(tab, btn) {
      console.log('showMeetingsTab called with tab:', tab);
      
      // Update tab buttons
      document.querySelectorAll('#meetings-section button[data-tab]').forEach(button => {
        button.classList.remove('bg-[#34D399]', 'text-[#1A2E29]', 'active-tab');
        button.classList.add('text-[#A3B3AF]');
      });

      if (!btn) {
        btn = document.querySelector(`#meetings-section button[data-tab="${tab}"]`);
      }
      if (btn) {
        btn.classList.remove('text-[#A3B3AF]');
        btn.classList.add('bg-[#34D399]', 'text-[#1A2E29]', 'active-tab');
        console.log('Active button classes:', btn.className);
      }

      // Update table content based on tab
      updateMeetingsTable(tab);
    }

    function updateMeetingsTable(tab) {
      console.log('updateMeetingsTable called with tab:', tab);
      const tbody = document.querySelector('#meetings-section tbody');
      console.log('Found tbody:', tbody);
      
      if (!tbody) {
        console.error('Could not find tbody element!');
        return;
      }
      
      const meetings = getMeetingsData(tab);
      console.log('Meetings for tab', tab, ':', meetings);
      
      const tableHTML = meetings.map(meeting => {
        let badgeClass =
          meeting.status === 'Confirmed' ? 'badge-success' :
          meeting.status === 'Pending' ? 'badge-warning' :
          meeting.status === 'Completed' ? 'badge-completed' :
          'badge-error';
        return `
        <tr class="table-row">
          <td class="py-2">
            <div class="flex items-center gap-2 justify-center">
              <img src="https://ui-avatars.com/api/?name=${encodeURIComponent(meeting.invitee)}&background=34D399&color=1A2E29" alt="${meeting.invitee}" class="w-8 h-8 rounded-full">
              <div>
                <div class="text-white font-medium">${meeting.invitee}</div>
                <div class="text-[#A3B3AF] text-sm">${meeting.email}</div>
              </div>
            </div>
          </td>
          <td class="py-2 text-center">${meeting.eventType}</td>
          <td class="py-2 text-center">${meeting.date}</td>
          <td class="py-2 text-center"><span class="${badgeClass}">${meeting.status}</span></td>
          <td class="py-2 text-center">
            <div class="relative inline-block text-left">
              <button class="kebab-btn flex items-center justify-center w-8 h-8 rounded-full hover:bg-[#223c36] transition-colors" type="button" onclick="toggleMeetingMenu(this)">
                <span class="material-icons-outlined">more_vert</span>
              </button>
              <div class="meeting-menu absolute bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg">
                <button class="w-full flex items-center gap-2 px-4 py-2 text-[#34D399] hover:bg-[#223c36] text-sm font-semibold" onclick="joinMeeting('${meeting.id}')">
                  <span class="material-icons-outlined text-xs">video_call</span>Join
                </button>
                ${tab === 'past' ? 
                  `<button class="w-full flex items-center gap-2 px-4 py-2 text-[#EF4444] hover:bg-[#223c36] text-sm font-semibold" onclick="deleteMeeting('${meeting.id}')">
                    <span class="material-icons-outlined text-xs">delete_forever</span>Delete
                  </button>` :
                  `<button class="w-full flex items-center gap-2 px-4 py-2 text-[#A3B3AF] hover:bg-[#223c36] text-sm font-semibold" onclick="rescheduleMeeting('${meeting.id}')">
                    <span class="material-icons-outlined text-xs">schedule</span>Reschedule
                  </button>
                  <button class="w-full flex items-center gap-2 px-4 py-2 text-[#EF4444] hover:bg-[#223c36] text-sm font-semibold" onclick="cancelMeeting('${meeting.id}')">
                    <span class="material-icons-outlined text-xs">close</span>Cancel
                  </button>`
                }
              </div>
            </div>
          </td>
        </tr>
      `;
      }).join('');
      
      console.log('Generated table HTML:', tableHTML);
      tbody.innerHTML = tableHTML;
      console.log('Table updated successfully');
    }

    // Store meetings data in a variable that can be modified
    let meetingsData = {
      upcoming: [
        { id: 1, invitee: 'Jane Doe', email: 'jane@example.com', eventType: '30-min Intro Call', date: 'Today, 2:00 PM', status: 'Confirmed' }
      ],
      past: [
        { id: 3, invitee: 'Alice Johnson', email: 'alice@test.com', eventType: '30-min Intro Call', date: 'Yesterday, 3:00 PM', status: 'Completed' }
      ],
      pending: [
        { id: 2, invitee: 'John Smith', email: 'john@company.com', eventType: '1-hour Consultation', date: 'Tomorrow, 10:00 AM', status: 'Pending' }
      ]
    };

    function getMeetingsData(tab) {
      return meetingsData[tab] || [];
    }

    function removeMeetingFromData(meetingId) {
      // Remove from all tabs
      Object.keys(meetingsData).forEach(tab => {
        meetingsData[tab] = meetingsData[tab].filter(meeting => meeting.id !== meetingId);
      });
    }

    // Meeting actions
    function meetingAction(action, meetingId) {
      const meeting = getMeetingsData('upcoming').find(m => m.id === meetingId) || 
                     getMeetingsData('past').find(m => m.id === meetingId);
      
      switch(action) {
        case 'join':
          alert(`Joining meeting with ${meeting.invitee}`);
          break;
        case 'reschedule':
          alert(`Rescheduling meeting with ${meeting.invitee}`);
          break;
      }
    }

    // Utility functions
    function copyLink(link) {
      navigator.clipboard.writeText(link);
      showNotification('Link copied to clipboard');
    }

    function openShareModal(title) {
      document.getElementById('share-modal-title').textContent = title;
      document.getElementById('share-modal').classList.remove('hidden');
      document.getElementById('modal-backdrop').classList.remove('hidden');
    }

    function closeShareModal() {
      document.getElementById('share-modal').classList.add('hidden');
      document.getElementById('modal-backdrop').classList.add('hidden');
    }

    function toggleCreateMenu() {
      const menu = document.getElementById('create-menu');
      menu.classList.toggle('hidden');
    }

    function toggleCardMenu(button) {
      const menu = button.nextElementSibling;
      menu.classList.toggle('hidden');
    }

    function openCreateEventTypeModal() {
      document.getElementById('modal-backdrop').classList.remove('hidden');
      document.getElementById('create-event-type-modal').classList.remove('hidden');
      document.getElementById('create-menu').classList.add('hidden');
    }

    function createWorkflow() {
      localStorage.removeItem('calendarify-current-workflow');
      window.location.href = '/dashboard/editor';
    }

    function editWorkflow(id) {
      localStorage.setItem('calendarify-current-workflow', id);
      window.location.href = '/dashboard/editor';
    }

    function cloneWorkflow(id) {
      let workflows = JSON.parse(localStorage.getItem('calendarify-workflows') || '[]');
      const wf = workflows.find(w => w.id === id);
      if (!wf) return;
      const newWf = { ...wf, id: Date.now().toString(), name: wf.name + ' Copy', lastEdited: 'just now' };
      workflows.push(newWf);
      localStorage.setItem('calendarify-workflows', JSON.stringify(workflows));
      renderWorkflows();
      showNotification('Workflow cloned');
    }

    function deleteWorkflow(id) {
      if (!confirm('Delete this workflow?')) return;
      let workflows = JSON.parse(localStorage.getItem('calendarify-workflows') || '[]');
      workflows = workflows.filter(w => w.id !== id);
      localStorage.setItem('calendarify-workflows', JSON.stringify(workflows));
      renderWorkflows();
      showNotification('Workflow deleted');
    }

    function toggleWorkflowStatus(id, checkbox) {
      let workflows = JSON.parse(localStorage.getItem('calendarify-workflows') || '[]');
      const wf = workflows.find(w => w.id === id);
      if (wf) {
        wf.status = checkbox.checked;
        localStorage.setItem('calendarify-workflows', JSON.stringify(workflows));
      }
    }

    function renderWorkflows() {
      const tbody = document.getElementById('workflows-tbody');
      let workflows = JSON.parse(localStorage.getItem('calendarify-workflows') || '[]');
      if (workflows.length === 0) {
        workflows = [
          { id: 'wf1', name: 'Send Reminder Email', status: true, eventTypes: 'Intro Call', lastEdited: '2 days ago' },
          { id: 'wf2', name: 'Post-Meeting SMS', status: false, eventTypes: 'All Event Types', lastEdited: '1 week ago' }
        ];
        localStorage.setItem('calendarify-workflows', JSON.stringify(workflows));
      }
      tbody.innerHTML = workflows.map(w => `
        <tr class="table-row">
          <td class="py-2">${w.name}</td>
          <td class="py-2"><input type="checkbox" class="custom-checkbox" ${w.status ? 'checked' : ''} onchange="toggleWorkflowStatus('${w.id}', this)"></td>
          <td class="py-2">${w.eventTypes}</td>
          <td class="py-2">${w.lastEdited}</td>
          <td class="py-2 flex gap-2">
            <button class="btn-secondary" onclick="editWorkflow('${w.id}')">Edit</button>
            <button class="btn-secondary" onclick="cloneWorkflow('${w.id}')">Clone</button>
            <button class="btn-secondary" onclick="deleteWorkflow('${w.id}')">Delete</button>
          </td>
        </tr>
      `).join('');
    }

    function addContact() {
      document.getElementById('modal-backdrop').classList.remove('hidden');
      document.getElementById('add-contact-modal').classList.remove('hidden');
    }



    function showNotification(message) {
      // Create notification element
      const notification = document.createElement('div');
      notification.className = 'fixed top-4 right-4 bg-[#34D399] text-[#1A2E29] px-4 py-2 rounded-lg shadow-lg z-50';
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      // Remove after 3 seconds
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    // Close modals when clicking backdrop
    document.getElementById('modal-backdrop').addEventListener('click', function() {
      document.querySelectorAll('.hidden').forEach(el => {
        if (el.id === 'modal-backdrop' || el.id === 'share-modal' || el.id === 'delete-event-type-confirm-modal' || el.id === 'cancel-meeting-confirm-modal' || el.id === 'delete-meeting-confirm-modal' || el.id === 'add-contact-modal') {
          el.classList.add('hidden');
        }
      });
      // Clear any stored meeting data
      window.meetingToCancel = null;
      window.meetingToDelete = null;
    });

    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.relative')) {
        document.querySelectorAll('.card-menu, #create-menu').forEach(menu => {
          menu.classList.add('hidden');
        });
      }
    });

    // --- 12h/24h Toggle Functionality ---
    function toggleClockFormat() {
      const is12h = getClockFormat() === '12h';
      const newFormat = is12h ? '24h' : '12h';
      
      // Store current time values before switching
      const timeInputs = document.querySelectorAll('input[type="time"]');
      const currentValues = Array.from(timeInputs).map(input => ({
        element: input,
        value: input.value,
        format: is12h ? '12h' : '24h'
      }));
      
      // Update format preference
      setClockFormat(newFormat);
      updateClockFormatUI();
      
      // Convert all time inputs to new format
      currentValues.forEach(({ element, value, format }) => {
        if (value) {
          const newValue = convertTimeFormat(value, format, newFormat);
          element.value = newValue;
        }
      });
      addAMPMDisplay();
    }

    function getClockFormat() {
      let stored = localStorage.getItem('calendarify-clock-format');
      if (!stored) {
        localStorage.setItem('calendarify-clock-format', '24h');
        return '24h';
      }
      return stored;
    }

    function setClockFormat(format) {
      localStorage.setItem('calendarify-clock-format', format);
    }

    function updateClockFormatUI() {
      const is12h = getClockFormat() === '12h';
      const toggle = document.getElementById('clock-format-toggle');
      const circle = document.getElementById('toggle-circle');
      if (toggle && circle) {
        toggle.setAttribute('aria-pressed', is12h ? 'true' : 'false');
        toggle.classList.toggle('bg-[#34D399]', is12h);
        toggle.classList.toggle('bg-[#19342e]', !is12h);
        circle.style.transform = is12h ? 'translateX(20px)' : 'translateX(0)';
        circle.style.backgroundColor = is12h ? '#fff' : '#34D399';
      }
    }

    function updateAllTimeInputs() {
      const is12h = getClockFormat() === '12h';
      document.querySelectorAll('input[type="time"]').forEach(input => {
        if (input.value) {
          // Convert from 24h (input default) to current format
          const newValue = convertTimeFormat(input.value, '24h', is12h ? '12h' : '24h');
          input.value = newValue;
        }
      });
      addAMPMDisplay();
    }

    // Converts time between formats, preserving the actual time
    function convertTimeFormat(value, fromFormat, toFormat) {
      if (!value || !/^\d{2}:\d{2}$/.test(value)) return value;
      
      let [hours, minutes] = value.split(':').map(Number);
      
      if (fromFormat === toFormat) {
        return value; // No conversion needed
      }
      
      if (fromFormat === '24h' && toFormat === '12h') {
        // Convert 24h to 12h
        if (hours === 0) {
          return `12:${minutes.toString().padStart(2, '0')}`;
        } else if (hours > 12) {
          return `${(hours - 12).toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        } else {
          return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        }
      } else if (fromFormat === '12h' && toFormat === '24h') {
        // Convert 12h to 24h
        // We need to determine AM/PM from context or assume AM for 1-11, PM for 12
        if (hours === 12) {
          return `12:${minutes.toString().padStart(2, '0')}`; // 12 PM
        } else if (hours >= 1 && hours <= 11) {
          return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`; // AM
        } else {
          // This shouldn't happen with valid 12h input, but fallback
          return value;
        }
      }
      
      return value;
    }

    // Add AM/PM display to time inputs
    function addAMPMDisplay() {
      const is12h = getClockFormat() === '12h';
      document.querySelectorAll('.time-input-wrap').forEach(wrapper => {
        const input = wrapper.querySelector('input[type="time"]');
        if (!input) return;
        let ampmSpan = wrapper.querySelector('.ampm-indicator');
        if (!ampmSpan) {
          ampmSpan = document.createElement('span');
          ampmSpan.className = 'ampm-indicator text-[#A3B3AF] text-sm ml-1';
          input.after(ampmSpan);
        }
        if (!is12h) {
          ampmSpan.textContent = '';
          ampmSpan.style.display = 'none';
          return;
        }
        ampmSpan.style.display = '';
        if (input.value) {
          let [hours] = input.value.split(':').map(Number);
          ampmSpan.textContent = (hours >= 12 ? 'PM' : 'AM');
        } else {
          ampmSpan.textContent = '';
        }
      });
    }

    // Update AM/PM display when time inputs change
    function setupTimeInputListeners() {
    document.querySelectorAll('input[type="time"]').forEach(input => {
        input.removeEventListener('change', addAMPMDisplay);
        input.removeEventListener('input', addAMPMDisplay);
        input.addEventListener('change', addAMPMDisplay);
        input.addEventListener('input', addAMPMDisplay);
      });
    }

    // Initialize the dashboard
    document.addEventListener('DOMContentLoaded', function() {
      updateClockFormatUI();
      updateAllCustomTimePickers();
      setupTimeInputListeners();
      renderWorkflows();
      // Remove all active classes from nav items
      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      const defaultNav = document.querySelector('.nav-item[data-section="event-types"]');
      if (defaultNav) {
        showSection('event-types', defaultNav);
      }
    });

    // --- Custom Time Picker ---
    function showTimeDropdown(input) {
      const picker = input.closest('.custom-time-picker');
      const dropdown = picker.querySelector('.time-dropdown');
      if (dropdown.classList.contains('open')) return; // Don't re-open if already open
      closeAllTimeDropdowns();
      const hourSel = dropdown.querySelector('.hour-select');
      const minSel = dropdown.querySelector('.minute-select');
      const ampmSel = dropdown.querySelector('.ampm-select');
      const is12h = getClockFormat() === '12h';
      // Populate hours
      hourSel.innerHTML = '';
      if (is12h) {
        for (let h = 1; h <= 12; h++) {
          hourSel.innerHTML += `<option value="${h.toString().padStart(2, '0')}">${h.toString().padStart(2, '0')}</option>`;
        }
        ampmSel.style.display = '';
      } else {
        for (let h = 0; h < 24; h++) {
          hourSel.innerHTML += `<option value="${h.toString().padStart(2, '0')}">${h.toString().padStart(2, '0')}</option>`;
        }
        ampmSel.style.display = 'none';
      }
      // Populate minutes
      minSel.innerHTML = '';
      for (let m = 0; m < 60; m += 5) {
        minSel.innerHTML += `<option value="${m.toString().padStart(2, '0')}">${m.toString().padStart(2, '0')}</option>`;
      }
      // Set current value
      let val = input.value || input.placeholder || (is12h ? '09:00 AM' : '09:00');
      let [h, m, ap] = parseTimeString(val, is12h);
      hourSel.value = h;
      minSel.value = m;
      if (is12h) ampmSel.value = ap;
      dropdown.classList.remove('hidden');
      setTimeout(() => { dropdown.classList.add('open'); }, 10);
    }

    function setTimeFromDropdown(btn, setValue) {
      const dropdown = btn.closest('.time-dropdown');
      const picker = dropdown.closest('.custom-time-picker');
      const input = picker.querySelector('input');
      const hourSel = dropdown.querySelector('.hour-select');
      const minSel = dropdown.querySelector('.minute-select');
      const ampmSel = dropdown.querySelector('.ampm-select');
      const is12h = getClockFormat() === '12h';
      let h = hourSel.value;
      let m = minSel.value;
      let ap = is12h ? ampmSel.value : '';
      let display = is12h ? `${h}:${m} ${ap}` : `${h}:${m}`;
      if (setValue) input.value = display;
      closeTimeDropdown(btn);
    }

    function closeTimeDropdown(el) {
      const dropdown = el.closest('.time-dropdown');
      dropdown.classList.remove('open');
      setTimeout(() => { dropdown.classList.add('hidden'); }, 150);
    }

    function closeAllTimeDropdowns() {
      document.querySelectorAll('.time-dropdown.open').forEach(dd => {
        dd.classList.remove('open');
        setTimeout(() => { dd.classList.add('hidden'); }, 150);
      });
    }

    function parseTimeString(val, is12h) {
      val = val.trim();
      let h = '09', m = '00', ap = 'AM';
      if (is12h) {
        let match = val.match(/^(\d{1,2}):(\d{2})\s*(AM|PM)?$/i);
        if (match) {
          h = match[1].padStart(2, '0');
          m = match[2];
          ap = (match[3] || 'AM').toUpperCase();
        }
      } else {
        let match = val.match(/^(\d{2}):(\d{2})$/);
        if (match) {
          h = match[1];
          m = match[2];
        }
      }
      return [h, m, ap];
    }

    // When toggling 12h/24h, update all custom pickers
    function updateAllCustomTimePickers() {
      document.querySelectorAll('.custom-time-picker input').forEach(input => {
        let val = input.value || input.placeholder || '09:00';
        let is12h = getClockFormat() === '12h';
        let [h, m, ap] = parseTimeString(val, !is12h);
        if (is12h) {
          // Convert 24h to 12h
          let hour = parseInt(h, 10);
          ap = hour >= 12 ? 'PM' : 'AM';
          hour = hour % 12 || 12;
          input.value = `${hour.toString().padStart(2, '0')}:${m} ${ap}`;
        } else {
          // Convert 12h to 24h
          let hour = parseInt(h, 10);
          if (ap === 'PM' && hour < 12) hour += 12;
          if (ap === 'AM' && hour === 12) hour = 0;
          input.value = `${hour.toString().padStart(2, '0')}:${m}`;
        }
      });
    }

    // Update all pickers on toggle
    const origToggleClockFormat = toggleClockFormat;
    toggleClockFormat = function() {
      origToggleClockFormat.apply(this, arguments);
      updateAllCustomTimePickers();
    };

    // Close dropdowns on outside click
    document.addEventListener('mousedown', function(e) {
      if (!e.target.closest('.custom-time-picker')) closeAllTimeDropdowns();
    });

    // --- Day Availability Toggle ---
    function toggleDayAvailability(day, button) {
      const isAvailable = button.getAttribute('aria-pressed') === 'true';
      const timeContainer = document.getElementById(day + '-times');
      const circle = button.querySelector('div');
      
      if (isAvailable) {
        // Disable the day (unavailable)
        button.setAttribute('aria-pressed', 'false');
        button.classList.remove('bg-[#34D399]');
        button.classList.add('bg-[#19342e]');
        circle.style.transform = 'translateX(0)';
        circle.style.backgroundColor = '#34D399';
        
        // Disable time inputs
        timeContainer.classList.add('opacity-50');
        timeContainer.querySelectorAll('input').forEach(input => {
          input.disabled = true;
          input.classList.add('cursor-not-allowed', 'bg-[#111f1c]', 'text-[#6B7C78]');
          input.classList.remove('cursor-pointer', 'bg-[#19342e]', 'text-[#E0E0E0]');
        });
      } else {
        // Enable the day (available)
        button.setAttribute('aria-pressed', 'true');
        button.classList.remove('bg-[#19342e]');
        button.classList.add('bg-[#34D399]');
        circle.style.transform = 'translateX(20px)';
        circle.style.backgroundColor = '#fff';
        
        // Enable time inputs
        timeContainer.classList.remove('opacity-50');
        timeContainer.querySelectorAll('input').forEach(input => {
          input.disabled = false;
          input.classList.remove('cursor-not-allowed', 'bg-[#111f1c]', 'text-[#6B7C78]');
          input.classList.add('cursor-pointer', 'bg-[#19342e]', 'text-[#E0E0E0]');
        });
      }
    }

    // --- Calendar Override System ---
    let currentDate = new Date();
    let selectedDate = null;
    let calendarOverrides = JSON.parse(localStorage.getItem('calendarify-overrides') || '{}');

    function initializeCalendar() {
      renderCalendar();
      updateOverrideList();
    }

    function renderCalendar() {
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      
      // Update month/year display
      const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                         'July', 'August', 'September', 'October', 'November', 'December'];
      document.getElementById('calendar-month-year').textContent = `${monthNames[month]} ${year}`;
      
      // Get first day of month and number of days
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      
      // Generate calendar days
      let calendarHTML = '';
      
      // Add empty cells for days before the first day of the month
      for (let i = 0; i < firstDay; i++) {
        calendarHTML += '<div class="calendar-day"></div>';
      }
      
      // Add days of the month
      for (let day = 1; day <= daysInMonth; day++) {
        const dateString = `${year}-${(month + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
        const hasOverride = calendarOverrides[dateString];
        const isToday = new Date().toDateString() === new Date(year, month, day).toDateString();
        
        let dayClasses = 'calendar-day cursor-pointer';
        
        if (hasOverride) {
          dayClasses += ' active';
        } else if (isToday) {
          dayClasses += ' today';
        }
        
        calendarHTML += `<div class="${dayClasses}" onclick="selectDate('${dateString}')">${day}</div>`;
      }
      
      document.getElementById('calendar-days').innerHTML = calendarHTML;
    }

    function previousMonth() {
      currentDate.setMonth(currentDate.getMonth() - 1);
      renderCalendar();
    }

    function nextMonth() {
      currentDate.setMonth(currentDate.getMonth() + 1);
      renderCalendar();
    }

    function selectDate(dateString) {
      selectedDate = dateString;
      const date = new Date(dateString);
      const formattedDate = date.toLocaleDateString('en-US', { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });
      
      document.getElementById('override-date').textContent = formattedDate;
      
      // Load existing override data if it exists
      const existingOverride = calendarOverrides[dateString];
      if (existingOverride) {
        loadOverrideData(existingOverride);
      } else {
        resetOverrideForm();
      }
      
      openOverrideModal();
    }

    function openOverrideModal() {
      document.getElementById('modal-backdrop').classList.remove('hidden');
      document.getElementById('override-modal').classList.remove('hidden');
    }

    function closeOverrideModal() {
      document.getElementById('modal-backdrop').classList.add('hidden');
      document.getElementById('override-modal').classList.add('hidden');
      selectedDate = null;
    }

    function toggleOverrideAvailability(button) {
      const isAvailable = button.getAttribute('aria-pressed') === 'true';
      const timesContainer = document.getElementById('override-times');
      const circle = button.querySelector('div');
      
      if (isAvailable) {
        // Disable availability
        button.setAttribute('aria-pressed', 'false');
        button.classList.remove('bg-[#34D399]');
        button.classList.add('bg-[#19342e]');
        circle.style.transform = 'translateX(0)';
        circle.style.backgroundColor = '#34D399';
        
        timesContainer.style.opacity = '0.5';
        timesContainer.style.pointerEvents = 'none';
      } else {
        // Enable availability
        button.setAttribute('aria-pressed', 'true');
        button.classList.remove('bg-[#19342e]');
        button.classList.add('bg-[#34D399]');
        circle.style.transform = 'translateX(20px)';
        circle.style.backgroundColor = '#fff';
        
        timesContainer.style.opacity = '1';
        timesContainer.style.pointerEvents = 'auto';
      }
    }

    function addOverrideTimeSlot() {
      const container = document.getElementById('override-times');
      const newSlot = document.createElement('div');
      newSlot.className = 'flex items-center gap-2';
      newSlot.innerHTML = `
        <span class="custom-time-picker relative inline-flex items-center w-28">
          <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="09:00 AM" onclick="showTimeDropdown(this)">
          <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
            <div class="flex gap-2 items-center justify-center">
              <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
              <span class="text-[#A3B3AF]">:</span>
              <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
              <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
            </div>
            <div class="flex justify-end mt-2 gap-2 w-full">
              <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
              <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
            </div>
          </div>
        </span>
        <span class="text-[#A3B3AF] flex-shrink-0">to</span>
        <span class="custom-time-picker relative inline-flex items-center w-28">
          <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="17:00 PM" onclick="showTimeDropdown(this)">
          <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
            <div class="flex gap-2 items-center justify-center">
              <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
              <span class="text-[#A3B3AF]">:</span>
              <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
              <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
            </div>
            <div class="flex justify-end mt-2 gap-2 w-full">
              <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
              <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
            </div>
          </div>
        </span>
        <button class="text-[#A3B3AF] hover:text-[#34D399] transition-colors duration-200 p-1 rounded hover:bg-[#19342e] flex-shrink-0" onclick="removeOverrideTimeSlot(this)">
          <span class="material-icons-outlined text-lg">remove</span>
        </button>
      `;
      container.appendChild(newSlot);
    }

    function removeOverrideTimeSlot(button) {
      button.closest('.flex').remove();
    }

    function loadOverrideData(override) {
      const toggleButton = document.querySelector('#override-modal button[onclick="toggleOverrideAvailability(this)"]');
      const timesContainer = document.getElementById('override-times');
      
      if (override.available) {
        toggleButton.setAttribute('aria-pressed', 'true');
        toggleButton.classList.add('bg-[#34D399]');
        toggleButton.classList.remove('bg-[#19342e]');
        toggleButton.querySelector('div').style.transform = 'translateX(20px)';
        toggleButton.querySelector('div').style.backgroundColor = '#fff';
        timesContainer.style.opacity = '1';
        timesContainer.style.pointerEvents = 'auto';
        
        // Load time slots
        timesContainer.innerHTML = '';
        if (override.timeSlots && override.timeSlots.length > 0) {
          override.timeSlots.forEach(slot => {
            addOverrideTimeSlot();
            const lastSlot = timesContainer.lastElementChild;
            const inputs = lastSlot.querySelectorAll('input');
            if (inputs && inputs.length >= 2) {
              inputs[0].value = slot.start || '';
              inputs[1].value = slot.end || '';
            }
          });
        } else {
          // Add default empty time slot
          addOverrideTimeSlot();
        }
      } else {
        toggleButton.setAttribute('aria-pressed', 'false');
        toggleButton.classList.remove('bg-[#34D399]');
        toggleButton.classList.add('bg-[#19342e]');
        toggleButton.querySelector('div').style.transform = 'translateX(0)';
        toggleButton.querySelector('div').style.backgroundColor = '#34D399';
        timesContainer.style.opacity = '0.5';
        timesContainer.style.pointerEvents = 'none';
      }
    }

    function resetOverrideForm() {
      const toggleButton = document.querySelector('#override-modal button[onclick="toggleOverrideAvailability(this)"]');
      const timesContainer = document.getElementById('override-times');
      
      toggleButton.setAttribute('aria-pressed', 'true');
      toggleButton.classList.add('bg-[#34D399]');
      toggleButton.classList.remove('bg-[#19342e]');
      toggleButton.querySelector('div').style.transform = 'translateX(20px)';
      toggleButton.querySelector('div').style.backgroundColor = '#fff';
      timesContainer.style.opacity = '1';
      timesContainer.style.pointerEvents = 'auto';
      
      // Reset to single time slot with proper structure
      timesContainer.innerHTML = `
        <div class="flex items-center gap-2">
          <span class="custom-time-picker relative inline-flex items-center w-28">
            <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="09:00 AM" onclick="showTimeDropdown(this)">
            <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
              <div class="flex gap-2 items-center justify-center">
                <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                <span class="text-[#A3B3AF]">:</span>
                <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
              </div>
              <div class="flex justify-end mt-2 gap-2 w-full">
                <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
              </div>
            </div>
          </span>
          <span class="text-[#A3B3AF] flex-shrink-0">to</span>
          <span class="custom-time-picker relative inline-flex items-center w-28">
            <input type="text" readonly class="time-input w-full flex-shrink-0 cursor-pointer bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded px-3 py-2 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399]" placeholder="17:00 PM" onclick="showTimeDropdown(this)">
            <div class="time-dropdown absolute left-0 top-full mt-1 min-w-full bg-[#1E3A34] border border-[#2C4A43] rounded-lg shadow-lg z-50 hidden p-2">
              <div class="flex gap-2 items-center justify-center">
                <select class="hour-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                <span class="text-[#A3B3AF]">:</span>
                <select class="minute-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]"></select>
                <select class="ampm-select bg-[#19342e] text-[#E0E0E0] rounded p-1 focus:ring-2 focus:ring-[#34D399]" style="display:none;"><option>AM</option><option>PM</option></select>
              </div>
              <div class="flex justify-end mt-2 gap-2 w-full">
                <button class="bg-[#34D399] text-[#1A2E29] px-3 py-1 rounded font-bold hover:bg-[#2C4A43] transition-colors" onclick="setTimeFromDropdown(this, true)">Set</button>
                <button class="text-[#A3B3AF] px-3 py-1 rounded hover:text-[#34D399]" onclick="closeTimeDropdown(this)">Cancel</button>
              </div>
            </div>
          </span>
          <button class="text-[#A3B3AF] hover:text-[#34D399] transition-colors duration-200 p-1 rounded hover:bg-[#19342e] flex-shrink-0" onclick="addOverrideTimeSlot()">
            <span class="material-icons-outlined text-lg">add</span>
          </button>
        </div>
      `;
    }

    function saveOverride() {
      if (!selectedDate) return;
      
      const toggleButton = document.querySelector('#override-modal button[onclick="toggleOverrideAvailability(this)"]');
      const isAvailable = toggleButton.getAttribute('aria-pressed') === 'true';
      
      if (isAvailable) {
        const timeSlots = [];
        const timeSlotElements = document.querySelectorAll('#override-times .flex');
        
        timeSlotElements.forEach(slot => {
          const inputs = slot.querySelectorAll('input');
          if (inputs && inputs.length >= 2 && inputs[0] && inputs[1] && inputs[0].value && inputs[1].value) {
            timeSlots.push({
              start: inputs[0].value,
              end: inputs[1].value
            });
          }
        });
        
        calendarOverrides[selectedDate] = {
          available: true,
          timeSlots: timeSlots
        };
      } else {
        calendarOverrides[selectedDate] = {
          available: false,
          timeSlots: []
        };
      }
      
      localStorage.setItem('calendarify-overrides', JSON.stringify(calendarOverrides));
      renderCalendar();
      updateOverrideList();
      closeOverrideModal();
      showNotification('Override saved successfully!');
    }

    function updateOverrideList() {
      const overrideList = document.getElementById('override-list');
      const overrides = Object.entries(calendarOverrides);
      
      if (overrides.length === 0) {
        overrideList.innerHTML = '<p class="text-[#A3B3AF] text-sm">No overrides set</p>';
        return;
      }
      
      const overrideHTML = overrides.map(([date, override]) => {
        const dateObj = new Date(date);
        const formattedDate = dateObj.toLocaleDateString('en-US', { 
          month: 'short', 
          day: 'numeric', 
          year: 'numeric' 
        });
        
        let statusText = override.available ? 'Available' : 'Unavailable';
        let statusClass = override.available ? 'text-[#34D399]' : 'text-[#A3B3AF]';
        
        if (override.available && override.timeSlots.length > 0) {
          const timeText = override.timeSlots.map(slot => `${slot.start} - ${slot.end}`).join(', ');
          statusText = timeText;
        }
        
        return `
          <div class="flex items-center justify-between p-3 bg-[#19342e] rounded-lg">
            <div>
              <div class="text-white font-medium">${formattedDate}</div>
              <div class="${statusClass} text-sm">${statusText}</div>
            </div>
            <div class="flex gap-2">
              <button class="text-[#A3B3AF] hover:text-[#34D399] transition-colors" onclick="editOverride('${date}')">
                <span class="material-icons-outlined text-lg">edit</span>
              </button>
              <button class="text-[#A3B3AF] hover:text-red-400 transition-colors" onclick="deleteOverride('${date}')">
                <span class="material-icons-outlined text-lg">delete</span>
              </button>
            </div>
          </div>
        `;
      }).join('');
      
      overrideList.innerHTML = overrideHTML;
    }

    function editOverride(dateString) {
      selectedDate = dateString;
      const date = new Date(dateString);
      const formattedDate = date.toLocaleDateString('en-US', { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });
      
      document.getElementById('override-date').textContent = formattedDate;
      loadOverrideData(calendarOverrides[dateString]);
      openOverrideModal();
    }

    function deleteOverride(dateString) {
      // Store the date to delete for the confirmation
      window.dateToDelete = dateString;
      
      // Show the custom confirmation modal
      document.getElementById('modal-backdrop').classList.remove('hidden');
      document.getElementById('delete-confirm-modal').classList.remove('hidden');
    }

    function confirmDeleteOverride() {
      const dateString = window.dateToDelete;
      if (dateString) {
        delete calendarOverrides[dateString];
        localStorage.setItem('calendarify-overrides', JSON.stringify(calendarOverrides));
        renderCalendar();
        updateOverrideList();
        showNotification('Override deleted successfully!');
      }
      
      // Close the modal
      closeDeleteConfirmModal();
      window.dateToDelete = null;
    }

    function closeDeleteConfirmModal() {
      document.getElementById('modal-backdrop').classList.add('hidden');
      document.getElementById('delete-confirm-modal').classList.add('hidden');
      window.dateToDelete = null;
    }

    function closeCreateEventTypeModal() {
      document.getElementById('modal-backdrop').classList.add('hidden');
      document.getElementById('create-event-type-modal').classList.add('hidden');
      resetCreateEventTypeForm();
    }

    function resetCreateEventTypeForm() {
      document.getElementById('event-type-name').value = '';
      document.getElementById('event-type-duration').value = '30';
      document.getElementById('event-type-type').value = '1-on-1';
      document.getElementById('event-type-attendee-limit').value = '10';
      document.getElementById('event-type-description').value = '';
      document.getElementById('event-type-location').value = 'zoom';
      document.getElementById('event-type-custom-location').value = '';
      document.getElementById('event-type-link').value = '';
      document.getElementById('event-type-color').value = '#34D399';
      document.getElementById('event-type-buffer-before').value = '0';
      document.getElementById('event-type-buffer-after').value = '0';
      document.getElementById('event-type-advance-notice').value = '0';
      document.getElementById('event-type-cancellation').value = '0';
      document.getElementById('event-type-timezone').value = 'auto';
      document.getElementById('event-type-booking-limit').value = '0';
      document.getElementById('event-type-custom-limit-count').value = '5';
      document.getElementById('event-type-custom-limit-period').value = 'day';
      document.getElementById('event-type-confirmation-message').value = '';
      document.getElementById('event-type-questions').value = '';
      document.getElementById('event-type-require-name').checked = true;
      document.getElementById('event-type-require-email').checked = true;
      document.getElementById('event-type-require-phone').checked = false;
      document.getElementById('event-type-require-company').checked = false;
      document.getElementById('event-type-availability').checked = true;
      document.getElementById('event-type-reminders').checked = true;
      document.getElementById('event-type-follow-up').checked = false;
      document.getElementById('event-type-cancellation-notification').checked = true;
      document.getElementById('event-type-reschedule-notification').checked = true;
      document.getElementById('event-type-secret').value = 'public';
      document.getElementById('event-type-priority').value = 'normal';
      document.getElementById('event-type-tags').value = '';
      
      // Reset visibility
      document.getElementById('attendee-limit-container').style.display = 'none';
      document.getElementById('custom-location-container').style.display = 'none';
      document.getElementById('meeting-link-container').style.display = 'block';
      document.getElementById('custom-booking-limit-container').style.display = 'none';
    }

    function saveEventType() {
      const name = document.getElementById('event-type-name').value.trim();
      const duration = document.getElementById('event-type-duration').value;
      const eventType = document.getElementById('event-type-type').value;
      const attendeeLimit = document.getElementById('event-type-attendee-limit').value;
      const description = document.getElementById('event-type-description').value.trim();
      const location = document.getElementById('event-type-location').value;
      const customLocation = document.getElementById('event-type-custom-location').value.trim();
      const link = document.getElementById('event-type-link').value.trim();
      const color = document.getElementById('event-type-color').value;
      const bufferBefore = document.getElementById('event-type-buffer-before').value;
      const bufferAfter = document.getElementById('event-type-buffer-after').value;
      const advanceNotice = document.getElementById('event-type-advance-notice').value;
      const cancellation = document.getElementById('event-type-cancellation').value;
      const timezone = document.getElementById('event-type-timezone').value;
      const bookingLimit = document.getElementById('event-type-booking-limit').value;
      const customLimitCount = document.getElementById('event-type-custom-limit-count').value;
      const customLimitPeriod = document.getElementById('event-type-custom-limit-period').value;
      const confirmationMessage = document.getElementById('event-type-confirmation-message').value.trim();
      const questions = document.getElementById('event-type-questions').value.trim();
      const requireName = document.getElementById('event-type-require-name').checked;
      const requireEmail = document.getElementById('event-type-require-email').checked;
      const requirePhone = document.getElementById('event-type-require-phone').checked;
      const requireCompany = document.getElementById('event-type-require-company').checked;
      const availability = document.getElementById('event-type-availability').checked;
      const reminders = document.getElementById('event-type-reminders').checked;
      const followUp = document.getElementById('event-type-follow-up').checked;
      const cancellationNotification = document.getElementById('event-type-cancellation-notification').checked;
      const rescheduleNotification = document.getElementById('event-type-reschedule-notification').checked;
      const secret = document.getElementById('event-type-secret').value;
      const priority = document.getElementById('event-type-priority').value;
      const tags = document.getElementById('event-type-tags').value.trim();

      if (!name) {
        showNotification('Event type name is required');
        return;
      }

      const eventTypeData = {
        name,
        duration: parseInt(duration),
        eventType,
        attendeeLimit: eventType !== '1-on-1' ? parseInt(attendeeLimit) : 1,
        description,
        location,
        customLocation: location === 'custom' ? customLocation : '',
        link: location !== 'office' ? link : '',
        color,
        bufferBefore: parseInt(bufferBefore),
        bufferAfter: parseInt(bufferAfter),
        advanceNotice: parseInt(advanceNotice),
        cancellation: parseInt(cancellation),
        timezone,
        bookingLimit: bookingLimit === 'custom' ? {
          count: parseInt(customLimitCount),
          period: customLimitPeriod
        } : parseInt(bookingLimit),
        confirmationMessage,
        questions,
        requiredFields: {
          name: requireName,
          email: requireEmail,
          phone: requirePhone,
          company: requireCompany
        },
        notifications: {
          availability,
          reminders,
          followUp,
          cancellation: cancellationNotification,
          reschedule: rescheduleNotification
        },
        visibility: secret,
        priority,
        tags: tags ? tags.split(',').map(tag => tag.trim()) : [],
        id: Date.now().toString()
      };

      // Get existing event types from localStorage
      let eventTypes = JSON.parse(localStorage.getItem('calendarify-event-types') || '[]');
      
      // Add new event type
      eventTypes.push(eventTypeData);
      
      // Save back to localStorage
      localStorage.setItem('calendarify-event-types', JSON.stringify(eventTypes));
      
      // Update the display
      renderEventTypes();
      
      showNotification('Event type created successfully!');
      closeCreateEventTypeModal();
    }

    // Interactive form functionality
    function handleEventTypeChange() {
      const eventType = document.getElementById('event-type-type').value;
      const attendeeContainer = document.getElementById('attendee-limit-container');
      
      if (eventType === '1-on-1') {
        attendeeContainer.style.display = 'none';
      } else {
        attendeeContainer.style.display = 'block';
      }
    }

    function handleLocationChange() {
      const location = document.getElementById('event-type-location').value;
      const customLocationContainer = document.getElementById('custom-location-container');
      const meetingLinkContainer = document.getElementById('meeting-link-container');
      
      if (location === 'custom') {
        customLocationContainer.style.display = 'block';
        meetingLinkContainer.style.display = 'none';
      } else if (location === 'office') {
        customLocationContainer.style.display = 'none';
        meetingLinkContainer.style.display = 'none';
      } else {
        customLocationContainer.style.display = 'none';
        meetingLinkContainer.style.display = 'block';
      }
    }

    function handleBookingLimitChange() {
      const bookingLimit = document.getElementById('event-type-booking-limit').value;
      const customLimitContainer = document.getElementById('custom-booking-limit-container');
      
      if (bookingLimit === 'custom') {
        customLimitContainer.style.display = 'block';
      } else {
        customLimitContainer.style.display = 'none';
      }
    }

    // Add event listeners for interactive form elements
    document.addEventListener('DOMContentLoaded', function() {
      renderEventTypes();
      
      // Add event listeners for form interactions
      const eventTypeSelect = document.getElementById('event-type-type');
      const locationSelect = document.getElementById('event-type-location');
      const bookingLimitSelect = document.getElementById('event-type-booking-limit');
      
      if (eventTypeSelect) {
        eventTypeSelect.addEventListener('change', handleEventTypeChange);
      }
      
      if (locationSelect) {
        locationSelect.addEventListener('change', handleLocationChange);
      }
      
      if (bookingLimitSelect) {
        bookingLimitSelect.addEventListener('change', handleBookingLimitChange);
      }
    });

    function renderEventTypes() {
      const eventTypesGrid = document.getElementById('event-types-grid');
      const eventTypes = JSON.parse(localStorage.getItem('calendarify-event-types') || '[]');
      
      // Start with the default event type
      let html = '';
      
      // Add created event types
      eventTypes.forEach(eventType => {
        const durationText = eventType.duration === 60 ? '1 hour' : 
                           eventType.duration === 90 ? '1.5 hours' : 
                           eventType.duration === 120 ? '2 hours' : 
                           eventType.duration === 180 ? '3 hours' :
                           eventType.duration === 240 ? '4 hours' :
                           `${eventType.duration} min`;
        
        const eventTypeText = eventType.eventType === '1-on-1' ? '1-on-1' :
                             eventType.eventType === 'group' ? 'Group' :
                             eventType.eventType === 'collective' ? 'Collective' :
                             eventType.eventType === 'round-robin' ? 'Round Robin' : '1-on-1';
        
        const attendeeText = eventType.eventType !== '1-on-1' ? ` • Up to ${eventType.attendeeLimit} people` : '';
        
        const locationText = eventType.location === 'zoom' ? 'Zoom' :
                            eventType.location === 'google-meet' ? 'Google Meet' :
                            eventType.location === 'teams' ? 'Microsoft Teams' :
                            eventType.location === 'skype' ? 'Skype' :
                            eventType.location === 'phone' ? 'Phone Call' :
                            eventType.location === 'office' ? 'In-person' :
                            eventType.location === 'custom' ? eventType.customLocation : 'Zoom';
        
        const visibilityBadge = eventType.visibility === 'secret' ? 
          '<span class="bg-[#FF6B6B] text-white px-2 py-1 rounded text-xs">Secret</span>' :
          eventType.visibility === 'private' ? 
          '<span class="bg-[#FFA500] text-white px-2 py-1 rounded text-xs">Private</span>' : '';
        
        const priorityBadge = eventType.priority === 'high' ? 
          '<span class="bg-[#FFD93D] text-[#1A2E29] px-2 py-1 rounded text-xs ml-2">High</span>' :
          eventType.priority === 'urgent' ? 
          '<span class="bg-[#FF6B6B] text-white px-2 py-1 rounded text-xs ml-2">Urgent</span>' : '';
        
        const tagsText = eventType.tags && eventType.tags.length > 0 ? 
          `<div class="flex flex-wrap gap-1 mt-1">${eventType.tags.map(tag => 
            `<span class="bg-[#19342e] text-[#A3B3AF] px-2 py-1 rounded text-xs">${tag}</span>`
          ).join('')}</div>` : '';
        
        html += `
          <div class="card flex flex-col gap-3" style="border-left: 4px solid ${eventType.color}">
            <div class="flex items-center justify-between">
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                  <h3 class="text-lg font-bold text-white">${eventType.name}</h3>
                  ${visibilityBadge}
                  ${priorityBadge}
                </div>
                <div class="text-[#A3B3AF] text-sm">${eventTypeText} • ${durationText}${attendeeText}</div>
                <div class="text-[#A3B3AF] text-sm mt-1">📍 ${locationText}</div>
                ${eventType.description ? `<div class="text-[#A3B3AF] text-sm mt-1">${eventType.description}</div>` : ''}
                ${tagsText}
              </div>
              <button class="text-[#A3B3AF] hover:text-[#34D399]" title="Favorite"><span class="material-icons-outlined">star_border</span></button>
            </div>
            <div class="flex gap-2 mt-2">
              <button class="bg-[#19342e] text-[#34D399] px-3 py-1 rounded-lg flex items-center gap-1 text-sm" onclick="copyLink('https://cal.example/${eventType.id}')"><span class="material-icons-outlined text-base">link</span>Copy link</button>
              <button class="bg-[#19342e] text-[#34D399] px-3 py-1 rounded-lg flex items-center gap-1 text-sm" onclick="openShareModal('${eventType.name}')"><span class="material-icons-outlined text-base">share</span>Share</button>
              <div class="relative">
                <button class="text-[#A3B3AF] hover:text-[#34D399] px-2 py-1 rounded-full" onclick="toggleCardMenu(this)"><span class="material-icons-outlined">more_vert</span></button>
                <div class="absolute right-0 mt-2 w-40 bg-[#1E3A34] rounded-lg shadow-lg py-2 z-50 hidden card-menu">
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]" onclick="editEventType('${eventType.id}')">Edit</button>
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]" onclick="cloneEventType('${eventType.id}')">Clone</button>
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]">Add Note</button>
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]">Mark Secret</button>
                  <button class="block w-full text-left px-4 py-2 text-[#E0E0E0] hover:bg-[#19342e]" onclick="deleteEventType('${eventType.id}')">Delete</button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      eventTypesGrid.innerHTML = html;
    }

    function deleteEventType(id) {
      // Store the event type ID to delete
      window.eventTypeToDelete = id;
      
      // Show custom confirmation modal
      document.getElementById('modal-backdrop').classList.remove('hidden');
      document.getElementById('delete-event-type-confirm-modal').classList.remove('hidden');
    }

    function confirmDeleteEventType() {
      const id = window.eventTypeToDelete;
      if (id) {
        let eventTypes = JSON.parse(localStorage.getItem('calendarify-event-types') || '[]');
        eventTypes = eventTypes.filter(eventType => eventType.id !== id);
        localStorage.setItem('calendarify-event-types', JSON.stringify(eventTypes));
        renderEventTypes();
        showNotification('Event type deleted successfully!');
        closeDeleteEventTypeConfirmModal();
        window.eventTypeToDelete = null;
      }
    }

    function closeDeleteEventTypeConfirmModal() {
      document.getElementById('modal-backdrop').classList.add('hidden');
      document.getElementById('delete-event-type-confirm-modal').classList.add('hidden');
      window.eventTypeToDelete = null;
    }

    function cloneEventType(id) {
      let eventTypes = JSON.parse(localStorage.getItem('calendarify-event-types') || '[]');
      const originalEventType = eventTypes.find(eventType => eventType.id === id);
      
      if (originalEventType) {
        const clonedEventType = {
          ...originalEventType,
          name: `${originalEventType.name} (Copy)`,
          id: Date.now().toString()
        };
        
        eventTypes.push(clonedEventType);
        localStorage.setItem('calendarify-event-types', JSON.stringify(eventTypes));
        renderEventTypes();
        showNotification('Event type cloned successfully!');
      }
    }

    function editEventType(id) {
      let eventTypes = JSON.parse(localStorage.getItem('calendarify-event-types') || '[]');
      const eventType = eventTypes.find(eventType => eventType.id === id);
      
      if (eventType) {
        // Store the event type being edited
        window.editingEventType = eventType;
        
        // Populate the form with existing data
        populateEditForm(eventType);
        
        // Show the edit modal
        document.getElementById('modal-backdrop').classList.remove('hidden');
        document.getElementById('edit-event-type-modal').classList.remove('hidden');
      }
    }

    function populateEditForm(eventType) {
      // Basic Information
      document.getElementById('edit-event-type-name').value = eventType.name;
      document.getElementById('edit-event-type-duration').value = eventType.duration;
      document.getElementById('edit-event-type-type').value = eventType.eventType;
      document.getElementById('edit-event-type-attendee-limit').value = eventType.attendeeLimit || 10;
      document.getElementById('edit-event-type-description').value = eventType.description || '';
      document.getElementById('edit-event-type-location').value = eventType.location;
      document.getElementById('edit-event-type-custom-location').value = eventType.customLocation || '';
      document.getElementById('edit-event-type-link').value = eventType.link || '';
      document.getElementById('edit-event-type-color').value = eventType.color;
      
      // Scheduling
      document.getElementById('edit-event-type-buffer-before').value = eventType.bufferBefore;
      document.getElementById('edit-event-type-buffer-after').value = eventType.bufferAfter;
      document.getElementById('edit-event-type-advance-notice').value = eventType.advanceNotice;
      document.getElementById('edit-event-type-cancellation').value = eventType.cancellation;
      document.getElementById('edit-event-type-timezone').value = eventType.timezone;
      
      // Booking limits
      if (typeof eventType.bookingLimit === 'object') {
        document.getElementById('edit-event-type-booking-limit').value = 'custom';
        document.getElementById('edit-event-type-custom-limit-count').value = eventType.bookingLimit.count;
        document.getElementById('edit-event-type-custom-limit-period').value = eventType.bookingLimit.period;
      } else {
        document.getElementById('edit-event-type-booking-limit').value = eventType.bookingLimit;
      }
      
      // Booking Form
      document.getElementById('edit-event-type-confirmation-message').value = eventType.confirmationMessage || '';
      document.getElementById('edit-event-type-questions').value = eventType.questions || '';
      
      // Required Fields
      document.getElementById('edit-event-type-require-name').checked = eventType.requiredFields?.name !== false;
      document.getElementById('edit-event-type-require-email').checked = eventType.requiredFields?.email !== false;
      document.getElementById('edit-event-type-require-phone').checked = eventType.requiredFields?.phone === true;
      document.getElementById('edit-event-type-require-company').checked = eventType.requiredFields?.company === true;
      
      // Notifications
      document.getElementById('edit-event-type-availability').checked = eventType.notifications?.availability !== false;
      document.getElementById('edit-event-type-reminders').checked = eventType.notifications?.reminders !== false;
      document.getElementById('edit-event-type-follow-up').checked = eventType.notifications?.followUp === true;
      document.getElementById('edit-event-type-cancellation-notification').checked = eventType.notifications?.cancellation !== false;
      document.getElementById('edit-event-type-reschedule-notification').checked = eventType.notifications?.reschedule !== false;
      
      // Advanced Settings
      document.getElementById('edit-event-type-secret').value = eventType.visibility;
      document.getElementById('edit-event-type-priority').value = eventType.priority;
      document.getElementById('edit-event-type-tags').value = eventType.tags ? eventType.tags.join(', ') : '';
      
      // Update form visibility based on current values
      handleEditEventTypeChange();
      handleEditLocationChange();
      handleEditBookingLimitChange();
    }

    function updateEventType() {
      const eventType = window.editingEventType;
      if (!eventType) return;
      
      // Collect all form data (same as saveEventType but with edit- prefixes)
      const name = document.getElementById('edit-event-type-name').value.trim();
      const duration = document.getElementById('edit-event-type-duration').value;
      const eventTypeValue = document.getElementById('edit-event-type-type').value;
      const attendeeLimit = document.getElementById('edit-event-type-attendee-limit').value;
      const description = document.getElementById('edit-event-type-description').value.trim();
      const location = document.getElementById('edit-event-type-location').value;
      const customLocation = document.getElementById('edit-event-type-custom-location').value.trim();
      const link = document.getElementById('edit-event-type-link').value.trim();
      const color = document.getElementById('edit-event-type-color').value;
      const bufferBefore = document.getElementById('edit-event-type-buffer-before').value;
      const bufferAfter = document.getElementById('edit-event-type-buffer-after').value;
      const advanceNotice = document.getElementById('edit-event-type-advance-notice').value;
      const cancellation = document.getElementById('edit-event-type-cancellation').value;
      const timezone = document.getElementById('edit-event-type-timezone').value;
      const bookingLimit = document.getElementById('edit-event-type-booking-limit').value;
      const customLimitCount = document.getElementById('edit-event-type-custom-limit-count').value;
      const customLimitPeriod = document.getElementById('edit-event-type-custom-limit-period').value;
      const confirmationMessage = document.getElementById('edit-event-type-confirmation-message').value.trim();
      const questions = document.getElementById('edit-event-type-questions').value.trim();
      const requireName = document.getElementById('edit-event-type-require-name').checked;
      const requireEmail = document.getElementById('edit-event-type-require-email').checked;
      const requirePhone = document.getElementById('edit-event-type-require-phone').checked;
      const requireCompany = document.getElementById('edit-event-type-require-company').checked;
      const availability = document.getElementById('edit-event-type-availability').checked;
      const reminders = document.getElementById('edit-event-type-reminders').checked;
      const followUp = document.getElementById('edit-event-type-follow-up').checked;
      const cancellationNotification = document.getElementById('edit-event-type-cancellation-notification').checked;
      const rescheduleNotification = document.getElementById('edit-event-type-reschedule-notification').checked;
      const secret = document.getElementById('edit-event-type-secret').value;
      const priority = document.getElementById('edit-event-type-priority').value;
      const tags = document.getElementById('edit-event-type-tags').value.trim();

      if (!name) {
        showNotification('Event type name is required');
        return;
      }

      // Update the event type data
      const updatedEventType = {
        ...eventType,
        name,
        duration: parseInt(duration),
        eventType: eventTypeValue,
        attendeeLimit: eventTypeValue !== '1-on-1' ? parseInt(attendeeLimit) : 1,
        description,
        location,
        customLocation: location === 'custom' ? customLocation : '',
        link: location !== 'office' ? link : '',
        color,
        bufferBefore: parseInt(bufferBefore),
        bufferAfter: parseInt(bufferAfter),
        advanceNotice: parseInt(advanceNotice),
        cancellation: parseInt(cancellation),
        timezone,
        bookingLimit: bookingLimit === 'custom' ? {
          count: parseInt(customLimitCount),
          period: customLimitPeriod
        } : parseInt(bookingLimit),
        confirmationMessage,
        questions,
        requiredFields: {
          name: requireName,
          email: requireEmail,
          phone: requirePhone,
          company: requireCompany
        },
        notifications: {
          availability,
          reminders,
          followUp,
          cancellation: cancellationNotification,
          reschedule: rescheduleNotification
        },
        visibility: secret,
        priority,
        tags: tags ? tags.split(',').map(tag => tag.trim()) : []
      };

      // Update in localStorage
      let eventTypes = JSON.parse(localStorage.getItem('calendarify-event-types') || '[]');
      const index = eventTypes.findIndex(et => et.id === eventType.id);
      if (index !== -1) {
        eventTypes[index] = updatedEventType;
        localStorage.setItem('calendarify-event-types', JSON.stringify(eventTypes));
        
        // Update the display
        renderEventTypes();
        
        showNotification('Event type updated successfully!');
        closeEditEventTypeModal();
      }
    }

    function closeEditEventTypeModal() {
      document.getElementById('modal-backdrop').classList.add('hidden');
      document.getElementById('edit-event-type-modal').classList.add('hidden');
      window.editingEventType = null;
    }

    // Edit form interactive functions
    function handleEditEventTypeChange() {
      const eventType = document.getElementById('edit-event-type-type').value;
      const attendeeContainer = document.getElementById('edit-attendee-limit-container');
      
      if (eventType === '1-on-1') {
        attendeeContainer.style.display = 'none';
      } else {
        attendeeContainer.style.display = 'block';
      }
    }

    function handleEditLocationChange() {
      const location = document.getElementById('edit-event-type-location').value;
      const customLocationContainer = document.getElementById('edit-custom-location-container');
      const meetingLinkContainer = document.getElementById('edit-meeting-link-container');
      
      if (location === 'custom') {
        customLocationContainer.style.display = 'block';
        meetingLinkContainer.style.display = 'none';
      } else if (location === 'office') {
        customLocationContainer.style.display = 'none';
        meetingLinkContainer.style.display = 'none';
      } else {
        customLocationContainer.style.display = 'none';
        meetingLinkContainer.style.display = 'block';
      }
    }

    function handleEditBookingLimitChange() {
      const bookingLimit = document.getElementById('edit-event-type-booking-limit').value;
      const customLimitContainer = document.getElementById('edit-custom-booking-limit-container');
      
      if (bookingLimit === 'custom') {
        customLimitContainer.style.display = 'block';
      } else {
        customLimitContainer.style.display = 'none';
      }
    }

    // Initialize event types on page load
    document.addEventListener('DOMContentLoaded', function() {
      let eventTypes = JSON.parse(localStorage.getItem('calendarify-event-types') || '[]');
      if (eventTypes.length === 0) {
        eventTypes.push({
          name: '30-min Intro Call',
          duration: 30,
          eventType: '1-on-1',
          attendeeLimit: 1,
          description: '',
          location: 'zoom',
          customLocation: '',
          link: '',
          color: '#34D399',
          bufferBefore: 0,
          bufferAfter: 0,
          advanceNotice: 0,
          cancellation: 0,
          timezone: 'auto',
          bookingLimit: 0,
          confirmationMessage: '',
          questions: '',
          requiredFields: { name: true, email: true, phone: false, company: false },
          notifications: { availability: true, reminders: true, followUp: false, cancellation: true, reschedule: true },
          visibility: 'public',
          priority: 'normal',
          tags: [],
          id: Date.now().toString() + Math.floor(Math.random()*10000)
        });
        localStorage.setItem('calendarify-event-types', JSON.stringify(eventTypes));
      }
      renderEventTypes();
      
      // Add event listeners for form interactions
      const eventTypeSelect = document.getElementById('event-type-type');
      const locationSelect = document.getElementById('event-type-location');
      const bookingLimitSelect = document.getElementById('event-type-booking-limit');
      
      if (eventTypeSelect) {
        eventTypeSelect.addEventListener('change', handleEventTypeChange);
      }
      
      if (locationSelect) {
        locationSelect.addEventListener('change', handleLocationChange);
      }
      
      if (bookingLimitSelect) {
        bookingLimitSelect.addEventListener('change', handleBookingLimitChange);
      }
    });

    function cancelMeeting(meetingId) {
      // Find the meeting by ID
      const meetings = JSON.parse(localStorage.getItem('calendarify-meetings') || '[]');
      const meeting = meetings.find(m => m.id === meetingId);
      
      if (!meeting) {
        showNotification('Meeting not found!', 'error');
        return;
      }
      
      // Store the meeting to cancel
      window.meetingToCancel = meeting;
      
      // Show custom confirmation modal
      document.getElementById('modal-backdrop').classList.remove('hidden');
      document.getElementById('cancel-meeting-confirm-modal').classList.remove('hidden');
    }

    // Removed duplicate confirmCancelMeeting function - using the updated version below

    // --- Meeting 3-dots menu logic ---
    function toggleMeetingMenu(btn) {
      // Close all other menus
      document.querySelectorAll('.meeting-menu').forEach(menu => menu.classList.remove('open'));
      // Toggle this one
      const menu = btn.nextElementSibling;
      if (menu) menu.classList.toggle('open');
    }
    document.addEventListener('click', function(e) {
      // If not clicking the kebab or menu, close all
      if (!e.target.closest('.kebab-btn') && !e.target.closest('.meeting-menu')) {
        document.querySelectorAll('.meeting-menu').forEach(menu => menu.classList.remove('open'));
      }
    });

    // --- Contact menu logic ---
    function toggleContactMenu(btn) {
      // Close all other menus
      document.querySelectorAll('.contact-menu').forEach(menu => menu.classList.remove('open'));
      // Toggle this one
      const menu = btn.nextElementSibling;
      if (menu) menu.classList.toggle('open');
    }
    
    // Contact actions
    function viewContact(email) {
      showNotification(`Viewing contact: ${email}`);
      // Here you would typically open a modal or navigate to contact details
    }
    
    function bookContact(email) {
      showNotification(`Booking meeting with: ${email}`);
      // Here you would typically open the booking flow
    }
    
    function removeContact(email) {
      if (confirm(`Are you sure you want to remove ${email} from your contacts?`)) {
        showNotification(`Contact removed: ${email}`);
        // Here you would typically remove the contact from the list
      }
    }
    
    let favoritesFilterActive = false;
    let searchFilter = '';

    function toggleFavorites() {
      favoritesFilterActive = !favoritesFilterActive;
      const btn = document.getElementById('favorites-filter-btn');
      
      if (favoritesFilterActive) {
        btn.classList.add('favorites-filter-active');
        showNotification('Showing favorites only');
      } else {
        btn.classList.remove('favorites-filter-active');
        showNotification('Showing all contacts');
      }
      
      filterContacts();
    }

    function filterContacts() {
      const rows = document.querySelectorAll('#contacts-section tbody tr');
      
      rows.forEach(row => {
        const favoriteBtn = row.querySelector('.favorite-btn');
        if (!favoriteBtn) return;
        
        const name = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
        const email = row.querySelector('td:nth-child(3)').textContent.toLowerCase();
        const isFavorited = favoriteBtn.querySelector('.material-icons-outlined').textContent === 'star';
        
        let showRow = true;
        
        // Apply search filter
        if (searchFilter && !name.includes(searchFilter) && !email.includes(searchFilter)) {
          showRow = false;
        }
        
        // Apply favorites filter
        if (favoritesFilterActive && !isFavorited) {
          showRow = false;
        }
        
        row.style.display = showRow ? '' : 'none';
      });
    }
    
    function toggleFavorite(email, button) {
      const starIcon = button.querySelector('.material-icons-outlined');
      const isFavorited = starIcon.textContent === 'star';
      
      if (isFavorited) {
        // Remove from favorites
        starIcon.textContent = 'star_border';
        button.classList.remove('favorited');
        button.classList.remove('text-[#34D399]');
        button.classList.add('text-[#A3B3AF]');
        showNotification(`${email} removed from favorites`);
      } else {
        // Add to favorites
        starIcon.textContent = 'star';
        button.classList.add('favorited');
        button.classList.remove('text-[#A3B3AF]');
        button.classList.add('text-[#34D399]');
        showNotification(`${email} added to favorites`);
      }
      
      // Re-apply filters after changing favorite status
      filterContacts();
      
      // Here you would typically save the favorite status to a database or localStorage
    }
    
    // Close contact dropdowns when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.kebab-btn') && !e.target.closest('.contact-menu')) {
        document.querySelectorAll('.contact-menu').forEach(menu => menu.classList.remove('open'));
      }
    });

    function closeAddContactModal() {
      document.getElementById('modal-backdrop').classList.add('hidden');
      document.getElementById('add-contact-modal').classList.add('hidden');
      // Clear form fields
      document.getElementById('contact-name').value = '';
      document.getElementById('contact-email').value = '';
      document.getElementById('contact-phone').value = '';
      document.getElementById('contact-company').value = '';
      document.getElementById('contact-notes').value = '';
      document.getElementById('contact-favorite').checked = false;
    }

    function saveContact() {
      const name = document.getElementById('contact-name').value.trim();
      const email = document.getElementById('contact-email').value.trim();
      const phone = document.getElementById('contact-phone').value.trim();
      const company = document.getElementById('contact-company').value.trim();
      const notes = document.getElementById('contact-notes').value.trim();
      const favorite = document.getElementById('contact-favorite').checked;

      if (!name || !email) {
        showNotification('Name and email are required');
        return;
      }

      if (!isValidEmail(email)) {
        showNotification('Please enter a valid email address');
        return;
      }

      // Here you would typically save to a database or localStorage
      const contact = {
        id: Date.now().toString(),
        name,
        email,
        phone,
        company,
        notes,
        favorite,
        createdAt: new Date().toISOString()
      };

      // For demo purposes, just show a success message
      showNotification(`Contact "${name}" added successfully!`);
      closeAddContactModal();
    }

    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }

    function handleSearch(event) {
      searchFilter = event.target.value.toLowerCase();
      filterContacts();
    }

    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }

    // Meetings search functionality
    let meetingsSearchFilter = '';

    function handleMeetingsSearch(event) {
      meetingsSearchFilter = event.target.value.toLowerCase();
      filterMeetings();
    }

    function filterMeetings() {
      const rows = document.querySelectorAll('#meetings-section tbody tr');
      
      rows.forEach(row => {
        const inviteeName = row.querySelector('td:nth-child(1) .text-white').textContent.toLowerCase();
        const inviteeEmail = row.querySelector('td:nth-child(1) .text-\\[\\#A3B3AF\\]').textContent.toLowerCase();
        const eventType = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
        const dateTime = row.querySelector('td:nth-child(3)').textContent.toLowerCase();
        
        let showRow = true;
        
        // Apply search filter
        if (meetingsSearchFilter && 
            !inviteeName.includes(meetingsSearchFilter) && 
            !inviteeEmail.includes(meetingsSearchFilter) && 
            !eventType.includes(meetingsSearchFilter) && 
            !dateTime.includes(meetingsSearchFilter)) {
          showRow = false;
        }
        
        row.style.display = showRow ? '' : 'none';
      });
    }

    // Export CSV functionality
    function exportCSV() {
      console.log('exportCSV called');
      
      const activeTabButton = document.querySelector('#meetings-section button.active-tab');
      if (!activeTabButton) {
        showNotification('Could not determine current tab');
        return;
      }
      
      const currentTab = activeTabButton.getAttribute('data-tab');
      console.log('Current tab:', currentTab);
      
      const meetings = getMeetingsData(currentTab);
      console.log('Meetings to export:', meetings);
      
      if (meetings.length === 0) {
        showNotification('No meetings to export');
        return;
      }
      
      // Create CSV content
      let csvContent = 'Invitee,Email,Event Type,Date/Time,Status\n';
      
      meetings.forEach(meeting => {
        const row = [
          meeting.invitee,
          meeting.email,
          meeting.eventType,
          meeting.date,
          meeting.status
        ].map(field => `"${field}"`).join(',');
        csvContent += row + '\n';
      });
      
      console.log('CSV content:', csvContent);
      
      // Create and download file
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `meetings_${currentTab}_${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
      
      showNotification(`Exported ${meetings.length} meetings to CSV`);
    }

    // Meeting action functions
    function joinMeeting(meetingId) {
      const id = typeof meetingId === 'string' ? parseInt(meetingId) : meetingId;
      const meeting = getMeetingsData('upcoming').find(m => m.id === id) || 
                     getMeetingsData('past').find(m => m.id === id) ||
                     getMeetingsData('pending').find(m => m.id === id);
      
      if (meeting) {
        showNotification(`Joining meeting with ${meeting.invitee}`);
        // Here you would typically open the meeting link or video call
      }
    }

    function rescheduleMeeting(meetingId) {
      const id = typeof meetingId === 'string' ? parseInt(meetingId) : meetingId;
      const meeting = getMeetingsData('upcoming').find(m => m.id === id) || 
                     getMeetingsData('pending').find(m => m.id === id);
      
      if (meeting) {
        showNotification(`Opening reschedule dialog for ${meeting.invitee}`);
        // Here you would typically open a reschedule modal
      } else {
        showNotification('Cannot reschedule past meetings');
      }
    }

    function cancelMeeting(meetingId) {
      console.log('cancelMeeting called with ID:', meetingId, 'Type:', typeof meetingId);
      
      // Convert to number if it's a string
      const id = typeof meetingId === 'string' ? parseInt(meetingId) : meetingId;
      console.log('Converted ID:', id);
      
      // Check all tabs to find the meeting
      const upcomingMeeting = getMeetingsData('upcoming').find(m => m.id === id);
      const pendingMeeting = getMeetingsData('pending').find(m => m.id === id);
      const pastMeeting = getMeetingsData('past').find(m => m.id === id);
      
      console.log('Found meetings:', { upcomingMeeting, pendingMeeting, pastMeeting });
      
      if (pastMeeting) {
        console.log('Past meeting found, cannot cancel');
        showNotification('Cannot cancel past meetings');
        return;
      }
      
      const meeting = upcomingMeeting || pendingMeeting;
      if (meeting) {
        console.log('Valid meeting found, showing confirmation modal');
        // Store meeting info for cancellation
        window.meetingToCancel = { id: id, invitee: meeting.invitee };
        
        // Show themed confirmation modal
        const backdrop = document.getElementById('modal-backdrop');
        const modal = document.getElementById('cancel-meeting-confirm-modal');
        
        if (backdrop && modal) {
          backdrop.classList.remove('hidden');
          modal.classList.remove('hidden');
          console.log('Cancel modal should be visible now');
        } else {
          console.error('Cancel modal elements not found:', { backdrop, modal });
          showNotification('Error: Modal not found');
        }
      } else {
        console.log('No valid meeting found');
        showNotification('Meeting not found');
      }
    }

    function deleteMeeting(meetingId) {
      console.log('deleteMeeting called with ID:', meetingId, 'Type:', typeof meetingId);
      
      // Convert to number if it's a string
      const id = typeof meetingId === 'string' ? parseInt(meetingId) : meetingId;
      console.log('Converted ID:', id);
      
      const meeting = getMeetingsData('past').find(m => m.id === id);
      
      if (meeting) {
        console.log('Found meeting to delete:', meeting);
        // Store meeting info for deletion
        window.meetingToDelete = { id: id, invitee: meeting.invitee };
        
        // Show themed confirmation modal
        const backdrop = document.getElementById('modal-backdrop');
        const modal = document.getElementById('delete-meeting-confirm-modal');
        
        if (backdrop && modal) {
          backdrop.classList.remove('hidden');
          modal.classList.remove('hidden');
          console.log('Modal should be visible now');
        } else {
          console.error('Modal elements not found:', { backdrop, modal });
          showNotification('Error: Modal not found');
        }
      } else {
        console.log('Meeting not found in past meetings');
        showNotification('Meeting not found');
      }
    }

    function confirmCancelMeeting() {
      const meetingInfo = window.meetingToCancel;
      if (meetingInfo) {
        console.log('Confirming cancellation for meeting:', meetingInfo);
        
        // First, close the modal
        closeCancelMeetingConfirmModal();
        window.meetingToCancel = null;
        
        // Then remove meeting from data (cancelled meetings are removed)
        removeMeetingFromData(meetingInfo.id);
        console.log('Meeting removed from data. Current data:', meetingsData);
        
        // Show notification
        showNotification(`Meeting with ${meetingInfo.invitee} has been cancelled`);
        
        // Finally, refresh the meetings table - try multiple ways to find current tab
        let currentTab = 'upcoming'; // default fallback
        const activeTabButton = document.querySelector('#meetings-section button.active-tab');
        if (activeTabButton) {
          currentTab = activeTabButton.getAttribute('data-tab');
        }
        
        console.log('Refreshing table for tab:', currentTab);
        // Use setTimeout to ensure the modal is fully closed before updating
        setTimeout(() => {
          updateMeetingsTable(currentTab);
        }, 100);
      }
    }

    function closeCancelMeetingConfirmModal() {
      document.getElementById('modal-backdrop').classList.add('hidden');
      document.getElementById('cancel-meeting-confirm-modal').classList.add('hidden');
      window.meetingToCancel = null;
    }

    function confirmDeleteMeeting() {
      const meetingInfo = window.meetingToDelete;
      if (meetingInfo) {
        console.log('Confirming deletion for meeting:', meetingInfo);
        
        // First, close the modal
        closeDeleteMeetingConfirmModal();
        window.meetingToDelete = null;
        
        // Then remove meeting from data
        removeMeetingFromData(meetingInfo.id);
        console.log('Meeting removed from data. Current data:', meetingsData);
        
        // Show notification
        showNotification(`Meeting with ${meetingInfo.invitee} has been deleted`);
        
        // Finally, refresh the meetings table - try multiple ways to find current tab
        let currentTab = 'past'; // default fallback for delete
        const activeTabButton = document.querySelector('#meetings-section button.active-tab');
        if (activeTabButton) {
          currentTab = activeTabButton.getAttribute('data-tab');
        }
        
        console.log('Refreshing table for tab:', currentTab);
        // Use setTimeout to ensure the modal is fully closed before updating
        setTimeout(() => {
          updateMeetingsTable(currentTab);
        }, 100);
      }
    }

    function closeDeleteMeetingConfirmModal() {
      document.getElementById('modal-backdrop').classList.add('hidden');
      document.getElementById('delete-meeting-confirm-modal').classList.add('hidden');
      window.meetingToDelete = null;
    }

    // Test function to verify everything is working
    function testMeetingsFunctionality() {
      console.log('=== Testing Meetings Functionality ===');
      console.log('Current meetings data:', meetingsData);
      
      // Test export
      console.log('Testing export...');
      exportCSV();
      
      // Test tab detection
      const activeButton = document.querySelector('#meetings-section button.active-tab');
      console.log('Active button found:', activeButton);
      if (activeButton) {
        console.log('Active tab:', activeButton.getAttribute('data-tab'));
      }
      
      // Test table update
      console.log('Testing table update...');
      updateMeetingsTable('upcoming');
    }

    // Simple test function to check if table updates work
    function testTableUpdate() {
      console.log('=== Testing Table Update ===');
      
      // Check if meetings section exists
      const meetingsSection = document.getElementById('meetings-section');
      console.log('Meetings section found:', meetingsSection);
      
      // Check if table exists
      const table = document.querySelector('#meetings-section table');
      console.log('Table found:', table);
      
      // Check if tbody exists
      const tbody = document.querySelector('#meetings-section tbody');
      console.log('Tbody found:', tbody);
      
      // Try to update the table
      console.log('Attempting to update table...');
      updateMeetingsTable('upcoming');
      
      // Check if content was added
      console.log('Tbody innerHTML after update:', tbody ? tbody.innerHTML : 'No tbody');
    }

    // Test function to manually trigger a meeting cancellation
    function testCancelMeeting() {
      console.log('=== Testing Cancel Meeting ===');
      
      // Create a test meeting
      const testMeeting = {
        id: 999,
        invitee: 'Test User',
        email: 'test@example.com',
        eventType: 'Test Meeting',
        date: 'Today, 1:00 PM',
        status: 'Confirmed'
      };
      
      // Add to upcoming meetings
      meetingsData.upcoming.push(testMeeting);
      console.log('Added test meeting to data:', meetingsData);
      
      // Set as meeting to cancel
      window.meetingToCancel = testMeeting;
      
      // Show confirmation modal
      document.getElementById('modal-backdrop').classList.remove('hidden');
      document.getElementById('cancel-meeting-confirm-modal').classList.remove('hidden');
      
      console.log('Test modal should be visible now');
    }
  </script>

  <!-- Create Event Type Modal -->
  <div id="create-event-type-modal" class="fixed inset-0 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-[#1E3A34] rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
        <!-- Header -->
        <div class="flex items-center justify-between p-6 border-b border-[#2C4A43]">
          <h2 class="text-2xl font-bold text-white">Create New Event Type</h2>
          <button onclick="closeCreateEventTypeModal()" class="text-[#A3B3AF] hover:text-white transition-colors">
            <span class="material-icons-outlined text-2xl">close</span>
          </button>
        </div>

        <!-- Content -->
        <div class="p-6 space-y-6">
          <!-- Basic Information -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Basic Information</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="event-type-name" class="block text-[#A3B3AF] text-sm font-medium mb-2">Event Name *</label>
                <input type="text" id="event-type-name" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="e.g., 30-min Intro Call">
              </div>
              
              <div>
                <label for="event-type-duration" class="block text-[#A3B3AF] text-sm font-medium mb-2">Duration</label>
                <select id="event-type-duration" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="15">15 minutes</option>
                  <option value="30" selected>30 minutes</option>
                  <option value="45">45 minutes</option>
                  <option value="60">1 hour</option>
                  <option value="90">1.5 hours</option>
                  <option value="120">2 hours</option>
                  <option value="180">3 hours</option>
                  <option value="240">4 hours</option>
                  <option value="custom">Custom duration</option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="event-type-type" class="block text-[#A3B3AF] text-sm font-medium mb-2">Event Type</label>
                <select id="event-type-type" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="1-on-1" selected>1-on-1</option>
                  <option value="group">Group</option>
                  <option value="collective">Collective</option>
                  <option value="round-robin">Round Robin</option>
                </select>
              </div>
              
              <div id="attendee-limit-container" style="display: none;">
                <label for="event-type-attendee-limit" class="block text-[#A3B3AF] text-sm font-medium mb-2">Max Attendees</label>
                <input type="number" id="event-type-attendee-limit" min="2" max="100" value="10" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
              </div>
            </div>

            <div>
              <label for="event-type-description" class="block text-[#A3B3AF] text-sm font-medium mb-2">Description</label>
              <textarea id="event-type-description" rows="3" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors resize-none" placeholder="Brief description of what this meeting is about"></textarea>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="event-type-location" class="block text-[#A3B3AF] text-sm font-medium mb-2">Location</label>
                <select id="event-type-location" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="zoom">Zoom</option>
                  <option value="google-meet">Google Meet</option>
                  <option value="teams">Microsoft Teams</option>
                  <option value="skype">Skype</option>
                  <option value="phone">Phone Call</option>
                  <option value="office">In-person (Office)</option>
                  <option value="custom">Custom Location</option>
                </select>
              </div>
              
              <div id="custom-location-container" style="display: none;">
                <label for="event-type-custom-location" class="block text-[#A3B3AF] text-sm font-medium mb-2">Custom Location</label>
                <input type="text" id="event-type-custom-location" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="Enter location details">
              </div>
            </div>

            <div id="meeting-link-container">
              <label for="event-type-link" class="block text-[#A3B3AF] text-sm font-medium mb-2">Meeting Link</label>
              <input type="url" id="event-type-link" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="https://zoom.us/j/...">
            </div>

            <div>
              <label for="event-type-color" class="block text-[#A3B3AF] text-sm font-medium mb-2">Color</label>
              <div class="flex items-center gap-3">
                <input type="color" id="event-type-color" value="#34D399" class="w-12 h-12 rounded-lg border-2 border-[#2C4A43] cursor-pointer">
                <span class="text-[#E0E0E0] text-sm">Choose a color to represent this event type</span>
              </div>
            </div>
          </div>

          <!-- Scheduling -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Scheduling</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="event-type-buffer-before" class="block text-[#A3B3AF] text-sm font-medium mb-2">Buffer Time Before</label>
                <select id="event-type-buffer-before" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No buffer</option>
                  <option value="5">5 minutes</option>
                  <option value="10">10 minutes</option>
                  <option value="15">15 minutes</option>
                  <option value="30">30 minutes</option>
                  <option value="60">1 hour</option>
                </select>
              </div>
              
              <div>
                <label for="event-type-buffer-after" class="block text-[#A3B3AF] text-sm font-medium mb-2">Buffer Time After</label>
                <select id="event-type-buffer-after" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No buffer</option>
                  <option value="5">5 minutes</option>
                  <option value="10">10 minutes</option>
                  <option value="15">15 minutes</option>
                  <option value="30">30 minutes</option>
                  <option value="60">1 hour</option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="event-type-advance-notice" class="block text-[#A3B3AF] text-sm font-medium mb-2">Advance Notice</label>
                <select id="event-type-advance-notice" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No minimum</option>
                  <option value="60">1 hour</option>
                  <option value="120">2 hours</option>
                  <option value="240">4 hours</option>
                  <option value="480">8 hours</option>
                  <option value="1440">1 day</option>
                  <option value="2880">2 days</option>
                  <option value="10080">1 week</option>
                </select>
              </div>
              
              <div>
                <label for="event-type-cancellation" class="block text-[#A3B3AF] text-sm font-medium mb-2">Cancellation Policy</label>
                <select id="event-type-cancellation" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No restrictions</option>
                  <option value="60">1 hour before</option>
                  <option value="120">2 hours before</option>
                  <option value="240">4 hours before</option>
                  <option value="1440">1 day before</option>
                  <option value="2880">2 days before</option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="event-type-timezone" class="block text-[#A3B3AF] text-sm font-medium mb-2">Timezone</label>
                <select id="event-type-timezone" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="auto">Auto-detect (recommended)</option>
                  <option value="UTC">UTC</option>
                  <option value="America/New_York">Eastern Time</option>
                  <option value="America/Chicago">Central Time</option>
                  <option value="America/Denver">Mountain Time</option>
                  <option value="America/Los_Angeles">Pacific Time</option>
                  <option value="Europe/London">London</option>
                  <option value="Europe/Paris">Paris</option>
                  <option value="Asia/Tokyo">Tokyo</option>
                  <option value="Australia/Sydney">Sydney</option>
                </select>
              </div>
              
              <div>
                <label for="event-type-booking-limit" class="block text-[#A3B3AF] text-sm font-medium mb-2">Booking Limit</label>
                <select id="event-type-booking-limit" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No limit</option>
                  <option value="1">1 per day</option>
                  <option value="2">2 per day</option>
                  <option value="3">3 per day</option>
                  <option value="5">5 per day</option>
                  <option value="10">10 per day</option>
                  <option value="custom">Custom limit</option>
                </select>
              </div>
            </div>

            <div id="custom-booking-limit-container" style="display: none;">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="event-type-custom-limit-count" class="block text-[#A3B3AF] text-sm font-medium mb-2">Limit Count</label>
                  <input type="number" id="event-type-custom-limit-count" min="1" max="100" value="5" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                </div>
                <div>
                  <label for="event-type-custom-limit-period" class="block text-[#A3B3AF] text-sm font-medium mb-2">Time Period</label>
                  <select id="event-type-custom-limit-period" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                    <option value="day">Per day</option>
                    <option value="week">Per week</option>
                    <option value="month">Per month</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Booking Form -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Booking Form</h3>
            
            <div>
              <label for="event-type-confirmation-message" class="block text-[#A3B3AF] text-sm font-medium mb-2">Confirmation Message</label>
              <textarea id="event-type-confirmation-message" rows="3" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors resize-none" placeholder="Message to show after booking confirmation"></textarea>
            </div>

            <div>
              <label for="event-type-questions" class="block text-[#A3B3AF] text-sm font-medium mb-2">Additional Questions</label>
              <textarea id="event-type-questions" rows="3" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors resize-none" placeholder="Questions to ask invitees when they book (one per line)"></textarea>
            </div>

            <div>
              <label class="block text-[#A3B3AF] text-sm font-medium mb-2">Required Fields</label>
              <div class="space-y-2">
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="event-type-require-name" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                  <span class="text-[#E0E0E0]">Name</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="event-type-require-email" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                  <span class="text-[#E0E0E0]">Email</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="event-type-require-phone" class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                  <span class="text-[#E0E0E0]">Phone Number</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="event-type-require-company" class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                  <span class="text-[#E0E0E0]">Company</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Notifications -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Notifications</h3>
            
            <div class="space-y-3">
              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="event-type-availability" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Show on availability calendar</span>
              </label>
              
              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="event-type-reminders" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Send reminder notifications</span>
              </label>
              
              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="event-type-follow-up" class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Send follow-up email after meeting</span>
              </label>

              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="event-type-cancellation-notification" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Send cancellation notifications</span>
              </label>

              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="event-type-reschedule-notification" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Send reschedule notifications</span>
              </label>
            </div>
          </div>

          <!-- Advanced Settings -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Advanced Settings</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="event-type-secret" class="block text-[#A3B3AF] text-sm font-medium mb-2">Visibility</label>
                <select id="event-type-secret" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="public">Public</option>
                  <option value="secret">Secret (hidden from profile)</option>
                  <option value="private">Private (invite only)</option>
                </select>
              </div>
              
              <div>
                <label for="event-type-priority" class="block text-[#A3B3AF] text-sm font-medium mb-2">Priority</label>
                <select id="event-type-priority" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="normal">Normal</option>
                  <option value="high">High Priority</option>
                  <option value="urgent">Urgent</option>
                </select>
              </div>
            </div>

            <div>
              <label for="event-type-tags" class="block text-[#A3B3AF] text-sm font-medium mb-2">Tags</label>
              <input type="text" id="event-type-tags" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="Enter tags separated by commas (e.g., sales, demo, consultation)">
            </div>
          </div>
        </div>

        <!-- Footer -->
        <div class="flex items-center justify-end gap-3 p-6 border-t border-[#2C4A43]">
          <button onclick="closeCreateEventTypeModal()" class="px-6 py-3 text-[#A3B3AF] hover:text-white transition-colors font-medium">
            Cancel
          </button>
          <button onclick="saveEventType()" class="bg-[#34D399] text-[#1A2E29] px-6 py-3 rounded-lg hover:bg-[#2C4A43] transition-colors font-bold">
            Create Event Type
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Event Type Modal -->
  <div id="edit-event-type-modal" class="fixed inset-0 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-[#1E3A34] rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
        <!-- Header -->
        <div class="flex items-center justify-between p-6 border-b border-[#2C4A43]">
          <h2 class="text-2xl font-bold text-white">Edit Event Type</h2>
          <button onclick="closeEditEventTypeModal()" class="text-[#A3B3AF] hover:text-white transition-colors">
            <span class="material-icons-outlined text-2xl">close</span>
          </button>
        </div>

        <!-- Content -->
        <div class="p-6 space-y-6">
          <!-- Basic Information -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Basic Information</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="edit-event-type-name" class="block text-[#A3B3AF] text-sm font-medium mb-2">Event Name *</label>
                <input type="text" id="edit-event-type-name" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="e.g., 30-min Intro Call">
              </div>
              
              <div>
                <label for="edit-event-type-duration" class="block text-[#A3B3AF] text-sm font-medium mb-2">Duration</label>
                <select id="edit-event-type-duration" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="15">15 minutes</option>
                  <option value="30" selected>30 minutes</option>
                  <option value="45">45 minutes</option>
                  <option value="60">1 hour</option>
                  <option value="90">1.5 hours</option>
                  <option value="120">2 hours</option>
                  <option value="180">3 hours</option>
                  <option value="240">4 hours</option>
                  <option value="custom">Custom duration</option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="edit-event-type-type" class="block text-[#A3B3AF] text-sm font-medium mb-2">Event Type</label>
                <select id="edit-event-type-type" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="1-on-1" selected>1-on-1</option>
                  <option value="group">Group</option>
                  <option value="collective">Collective</option>
                  <option value="round-robin">Round Robin</option>
                </select>
              </div>
              
              <div id="edit-attendee-limit-container" style="display: none;">
                <label for="edit-event-type-attendee-limit" class="block text-[#A3B3AF] text-sm font-medium mb-2">Max Attendees</label>
                <input type="number" id="edit-event-type-attendee-limit" min="2" max="100" value="10" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
              </div>
            </div>

            <div>
              <label for="edit-event-type-description" class="block text-[#A3B3AF] text-sm font-medium mb-2">Description</label>
              <textarea id="edit-event-type-description" rows="3" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors resize-none" placeholder="Brief description of what this meeting is about"></textarea>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="edit-event-type-location" class="block text-[#A3B3AF] text-sm font-medium mb-2">Location</label>
                <select id="edit-event-type-location" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="zoom">Zoom</option>
                  <option value="google-meet">Google Meet</option>
                  <option value="teams">Microsoft Teams</option>
                  <option value="skype">Skype</option>
                  <option value="phone">Phone Call</option>
                  <option value="office">In-person (Office)</option>
                  <option value="custom">Custom Location</option>
                </select>
              </div>
              
              <div id="edit-custom-location-container" style="display: none;">
                <label for="edit-event-type-custom-location" class="block text-[#A3B3AF] text-sm font-medium mb-2">Custom Location</label>
                <input type="text" id="edit-event-type-custom-location" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="Enter location details">
              </div>
            </div>

            <div id="edit-meeting-link-container">
              <label for="edit-event-type-link" class="block text-[#A3B3AF] text-sm font-medium mb-2">Meeting Link</label>
              <input type="url" id="edit-event-type-link" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="https://zoom.us/j/...">
            </div>

            <div>
              <label for="edit-event-type-color" class="block text-[#A3B3AF] text-sm font-medium mb-2">Color</label>
              <div class="flex items-center gap-3">
                <input type="color" id="edit-event-type-color" value="#34D399" class="w-12 h-12 rounded-lg border-2 border-[#2C4A43] cursor-pointer">
                <span class="text-[#E0E0E0] text-sm">Choose a color to represent this event type</span>
              </div>
            </div>
          </div>

          <!-- Scheduling -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Scheduling</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="edit-event-type-buffer-before" class="block text-[#A3B3AF] text-sm font-medium mb-2">Buffer Time Before</label>
                <select id="edit-event-type-buffer-before" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No buffer</option>
                  <option value="5">5 minutes</option>
                  <option value="10">10 minutes</option>
                  <option value="15">15 minutes</option>
                  <option value="30">30 minutes</option>
                  <option value="60">1 hour</option>
                </select>
              </div>
              
              <div>
                <label for="edit-event-type-buffer-after" class="block text-[#A3B3AF] text-sm font-medium mb-2">Buffer Time After</label>
                <select id="edit-event-type-buffer-after" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No buffer</option>
                  <option value="5">5 minutes</option>
                  <option value="10">10 minutes</option>
                  <option value="15">15 minutes</option>
                  <option value="30">30 minutes</option>
                  <option value="60">1 hour</option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="edit-event-type-advance-notice" class="block text-[#A3B3AF] text-sm font-medium mb-2">Advance Notice</label>
                <select id="edit-event-type-advance-notice" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No minimum</option>
                  <option value="60">1 hour</option>
                  <option value="120">2 hours</option>
                  <option value="240">4 hours</option>
                  <option value="480">8 hours</option>
                  <option value="1440">1 day</option>
                  <option value="2880">2 days</option>
                  <option value="10080">1 week</option>
                </select>
              </div>
              
              <div>
                <label for="edit-event-type-cancellation" class="block text-[#A3B3AF] text-sm font-medium mb-2">Cancellation Policy</label>
                <select id="edit-event-type-cancellation" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No restrictions</option>
                  <option value="60">1 hour before</option>
                  <option value="120">2 hours before</option>
                  <option value="240">4 hours before</option>
                  <option value="1440">1 day before</option>
                  <option value="2880">2 days before</option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="edit-event-type-timezone" class="block text-[#A3B3AF] text-sm font-medium mb-2">Timezone</label>
                <select id="edit-event-type-timezone" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="auto">Auto-detect (recommended)</option>
                  <option value="UTC">UTC</option>
                  <option value="America/New_York">Eastern Time</option>
                  <option value="America/Chicago">Central Time</option>
                  <option value="America/Denver">Mountain Time</option>
                  <option value="America/Los_Angeles">Pacific Time</option>
                  <option value="Europe/London">London</option>
                  <option value="Europe/Paris">Paris</option>
                  <option value="Asia/Tokyo">Tokyo</option>
                  <option value="Australia/Sydney">Sydney</option>
                </select>
              </div>
              
              <div>
                <label for="edit-event-type-booking-limit" class="block text-[#A3B3AF] text-sm font-medium mb-2">Booking Limit</label>
                <select id="edit-event-type-booking-limit" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="0">No limit</option>
                  <option value="1">1 per day</option>
                  <option value="2">2 per day</option>
                  <option value="3">3 per day</option>
                  <option value="5">5 per day</option>
                  <option value="10">10 per day</option>
                  <option value="custom">Custom limit</option>
                </select>
              </div>
            </div>

            <div id="edit-custom-booking-limit-container" style="display: none;">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="edit-event-type-custom-limit-count" class="block text-[#A3B3AF] text-sm font-medium mb-2">Limit Count</label>
                  <input type="number" id="edit-event-type-custom-limit-count" min="1" max="100" value="5" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                </div>
                <div>
                  <label for="edit-event-type-custom-limit-period" class="block text-[#A3B3AF] text-sm font-medium mb-2">Time Period</label>
                  <select id="edit-event-type-custom-limit-period" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                    <option value="day">Per day</option>
                    <option value="week">Per week</option>
                    <option value="month">Per month</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Booking Form -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Booking Form</h3>
            
            <div>
              <label for="edit-event-type-confirmation-message" class="block text-[#A3B3AF] text-sm font-medium mb-2">Confirmation Message</label>
              <textarea id="edit-event-type-confirmation-message" rows="3" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors resize-none" placeholder="Message to show after booking confirmation"></textarea>
            </div>

            <div>
              <label for="edit-event-type-questions" class="block text-[#A3B3AF] text-sm font-medium mb-2">Additional Questions</label>
              <textarea id="edit-event-type-questions" rows="3" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors resize-none" placeholder="Questions to ask invitees when they book (one per line)"></textarea>
            </div>

            <div>
              <label class="block text-[#A3B3AF] text-sm font-medium mb-2">Required Fields</label>
              <div class="space-y-2">
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="edit-event-type-require-name" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                  <span class="text-[#E0E0E0]">Name</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="edit-event-type-require-email" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                  <span class="text-[#E0E0E0]">Email</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="edit-event-type-require-phone" class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                  <span class="text-[#E0E0E0]">Phone Number</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="edit-event-type-require-company" class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                  <span class="text-[#E0E0E0]">Company</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Notifications -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Notifications</h3>
            
            <div class="space-y-3">
              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="edit-event-type-availability" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Show on availability calendar</span>
              </label>
              
              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="edit-event-type-reminders" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Send reminder notifications</span>
              </label>
              
              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="edit-event-type-follow-up" class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Send follow-up email after meeting</span>
              </label>

              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="edit-event-type-cancellation-notification" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Send cancellation notifications</span>
              </label>

              <label class="flex items-center gap-3 cursor-pointer">
                <input type="checkbox" id="edit-event-type-reschedule-notification" checked class="w-5 h-5 text-[#34D399] bg-[#19342e] border-[#2C4A43] rounded focus:ring-[#34D399] focus:ring-2">
                <span class="text-[#E0E0E0]">Send reschedule notifications</span>
              </label>
            </div>
          </div>

          <!-- Advanced Settings -->
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-white">Advanced Settings</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="edit-event-type-secret" class="block text-[#A3B3AF] text-sm font-medium mb-2">Visibility</label>
                <select id="edit-event-type-secret" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="public">Public</option>
                  <option value="secret">Secret (hidden from profile)</option>
                  <option value="private">Private (invite only)</option>
                </select>
              </div>
              
              <div>
                <label for="edit-event-type-priority" class="block text-[#A3B3AF] text-sm font-medium mb-2">Priority</label>
                <select id="edit-event-type-priority" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors">
                  <option value="normal">Normal</option>
                  <option value="high">High Priority</option>
                  <option value="urgent">Urgent</option>
                </select>
              </div>
            </div>

            <div>
              <label for="edit-event-type-tags" class="block text-[#A3B3AF] text-sm font-medium mb-2">Tags</label>
              <input type="text" id="edit-event-type-tags" class="w-full bg-[#19342e] border border-[#2C4A43] text-[#E0E0E0] rounded-lg px-4 py-3 focus:border-[#34D399] focus:ring-2 focus:ring-[#34D399] transition-colors" placeholder="Enter tags separated by commas (e.g., sales, demo, consultation)">
            </div>
          </div>
        </div>

        <!-- Footer -->
        <div class="flex items-center justify-end gap-3 p-6 border-t border-[#2C4A43]">
          <button onclick="closeEditEventTypeModal()" class="px-6 py-3 text-[#A3B3AF] hover:text-white transition-colors font-medium">
            Cancel
          </button>
          <button onclick="updateEventType()" class="bg-[#34D399] text-[#1A2E29] px-6 py-3 rounded-lg hover:bg-[#2C4A43] transition-colors font-bold">
            Update Event Type
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Event Type Confirmation Modal -->
  <div id="delete-event-type-confirm-modal" class="fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-[#1E3A34] rounded-xl p-8 z-50 hidden" style="min-width:400px;">
    <div class="flex items-center gap-3 mb-4">
      <span class="material-icons-outlined text-2xl text-red-400">warning</span>
      <h3 class="text-lg font-bold text-white">Delete Event Type</h3>
    </div>
    <p class="text-[#A3B3AF] mb-6">Are you sure you want to delete this event type? This action cannot be undone.</p>
    <div class="flex gap-3">
      <button class="bg-red-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-600 transition-colors" onclick="confirmDeleteEventType()">Delete</button>
      <button class="text-[#A3B3AF] px-6 py-2 rounded-lg hover:text-white transition-colors" onclick="closeDeleteEventTypeConfirmModal()">Cancel</button>
    </div>
  </div>

  <!-- Cancel Meeting Confirmation Modal -->
  <div id="cancel-meeting-confirm-modal" class="fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-[#1E3A34] rounded-xl p-8 z-50 hidden" style="min-width:400px;">
    <div class="flex items-center gap-3 mb-4">
      <span class="material-icons-outlined text-2xl text-red-400">warning</span>
      <h3 class="text-lg font-bold text-white">Cancel Meeting</h3>
    </div>
    <p class="text-[#A3B3AF] mb-6">Are you sure you want to cancel this meeting? This action cannot be undone.</p>
    <div class="flex gap-3">
      <button class="bg-red-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-600 transition-colors" onclick="confirmCancelMeeting()">Cancel Meeting</button>
      <button class="text-[#A3B3AF] px-6 py-2 rounded-lg hover:text-white transition-colors" onclick="closeCancelMeetingConfirmModal()">Keep Meeting</button>
    </div>
  </div>

  <!-- Delete Meeting Confirmation Modal -->
  <div id="delete-meeting-confirm-modal" class="fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-[#1E3A34] rounded-xl p-8 z-50 hidden" style="min-width:400px;">
    <div class="flex items-center gap-3 mb-4">
      <span class="material-icons-outlined text-2xl text-red-400">delete_forever</span>
      <h3 class="text-lg font-bold text-white">Delete Meeting</h3>
    </div>
    <p class="text-[#A3B3AF] mb-6">Are you sure you want to delete this meeting from your history? This action cannot be undone.</p>
    <div class="flex gap-3">
      <button class="bg-red-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-600 transition-colors" onclick="confirmDeleteMeeting()">Delete</button>
      <button class="text-[#A3B3AF] px-6 py-2 rounded-lg hover:text-white transition-colors" onclick="closeDeleteMeetingConfirmModal()">Cancel</button>
    </div>
  </div>
</body>
</html>

