<!DOCTYPE html>
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Spline+Sans%3Awght%40400%3B500%3B700"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <style>
      .nav-indicator {
        position: absolute;
        bottom: -3px;
        height: 2px;
        background-color: #38e07b;
        transition: all 0.3s ease;
        left: 0;
        width: 0;
      }
      .nav-link {
        position: relative;
        color: #9eb7a8;
        transition: color 0.3s ease;
      }
      .nav-link:hover {
        color: #38e07b;
      }
      .nav-link.active {
        color: #38e07b;
      }
      .nav-container {
        position: relative;
      }
    </style>
  </head>
  <body>
    <div class="relative flex size-full min-h-screen flex-col bg-[#111714] dark group/design-root overflow-x-hidden" style='font-family: "Spline Sans", "Noto Sans", sans-serif;'>
      <div class="layout-container flex h-full grow flex-col">
        <header class="sticky top-0 z-50 flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#29382f] px-10 py-3 bg-[#111714]">
          <a href="index.html" class="flex items-center gap-4 text-white">
            <div class="size-4">
              <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M24 45.8096C19.6865 45.8096 15.4698 44.5305 11.8832 42.134C8.29667 39.7376 5.50128 36.3314 3.85056 32.3462C2.19985 28.361 1.76794 23.9758 2.60947 19.7452C3.451 15.5145 5.52816 11.6284 8.57829 8.5783C11.6284 5.52817 15.5145 3.45101 19.7452 2.60948C23.9758 1.76795 28.361 2.19986 32.3462 3.85057C36.3314 5.50129 39.7376 8.29668 42.134 11.8833C44.5305 15.4698 45.8096 19.6865 45.8096 24L24 24L24 45.8096Z"
                  fill="currentColor"
                ></path>
              </svg>
            </div>
            <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">Calendarify</h2>
          </a>
          <div class="flex flex-1 justify-end gap-8">
            <div class="nav-container flex items-center gap-9 relative">
              <a class="nav-link text-white text-sm font-medium leading-normal" href="individuals.html">Individuals</a>
              <a class="nav-link text-white text-sm font-medium leading-normal" href="teams.html">Teams</a>
              <a class="nav-link text-white text-sm font-medium leading-normal" href="enterprise.html">Enterprise</a>
              <a
                href="log-in.html"
                class="nav-link active flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#38e07b] text-[#111714] text-sm font-bold leading-normal tracking-[0.015em]"
              >
                <span class="truncate text-[#111714]">Log in</span>
              </a>
              <div class="nav-indicator" id="navIndicator"></div>
            </div>
          </div>
        </header>
        <div class="px-4 sm:px-40 flex flex-col flex-1 py-5 space-y-6">
          <h2 class="text-white text-2xl font-bold text-center">Welcome, <span id="username"></span></h2>
          <div id="calendar" class="grid grid-cols-7 gap-2 text-white"></div>
        </div>
        <div id="modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
          <div class="bg-[#111714] p-6 rounded-xl text-white">
            <p id="modal-date" class="mb-4"></p>
            <input id="modal-time" type="time" class="form-input bg-[#29382f] text-white" />
            <div class="mt-4 text-right">
              <button id="close-modal" class="bg-[#38e07b] text-[#111714] rounded px-4 py-2">Close</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
          const navLinks = document.querySelectorAll('.nav-link');
          const indicator = document.getElementById('navIndicator');
          let activeLink = document.querySelector('.nav-link.active');
          let hoveredLink = null;

        function updateIndicator(element) {
          if (!element) return;

          const rect = element.getBoundingClientRect();
          const container = element.closest('.nav-container');
          const containerRect = container.getBoundingClientRect();

          indicator.style.width = `${rect.width}px`;
          indicator.style.left = `${rect.left - containerRect.left}px`;
        }

        if (activeLink) {
          requestAnimationFrame(() => {
            updateIndicator(activeLink);
          });
        }

        navLinks.forEach(link => {
          link.addEventListener('mouseenter', () => {
            hoveredLink = link;
            updateIndicator(link);
          });

          link.addEventListener('mouseleave', () => {
            hoveredLink = null;
            if (activeLink) {
              updateIndicator(activeLink);
            }
          });
        });

          window.addEventListener('resize', () => {
            if (hoveredLink) {
              updateIndicator(hoveredLink);
            } else if (activeLink) {
              updateIndicator(activeLink);
            }
          });

          const params = new URLSearchParams(window.location.search);
          document.getElementById('username').textContent = params.get('user') || 'test user';

          const calendarEl = document.getElementById('calendar');
          const modal = document.getElementById('modal');
          const modalDate = document.getElementById('modal-date');
          const modalTime = document.getElementById('modal-time');
          const closeModal = document.getElementById('close-modal');

          function fetchAvailability(date) {
            // Placeholder: later fetch availability from server
            return Promise.resolve();
          }

          function openModal(date) {
            modalDate.textContent = date.toDateString();
            modalTime.value = '';
            modal.classList.remove('hidden');
          }

          closeModal.addEventListener('click', () => {
            modal.classList.add('hidden');
          });

          function buildCalendar() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const dayNames = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
            calendarEl.innerHTML = '';
            dayNames.forEach(n => {
              const div = document.createElement('div');
              div.textContent = n;
              div.className = 'text-center font-bold';
              calendarEl.appendChild(div);
            });
            for (let i = 0; i < firstDay.getDay(); i++) {
              calendarEl.appendChild(document.createElement('div'));
            }
            for (let d = 1; d <= lastDay.getDate(); d++) {
              const date = new Date(year, month, d);
              const cell = document.createElement('div');
              cell.textContent = d;
              cell.className = 'p-2 text-center rounded cursor-pointer hover:bg-[#29382f]';
              cell.addEventListener('click', () => {
                fetchAvailability(date).then(() => openModal(date));
              });
              calendarEl.appendChild(cell);
            }
          }

          buildCalendar();
        });
      </script>
  </body>
</html>
